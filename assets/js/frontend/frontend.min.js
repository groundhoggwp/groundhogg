(function(gh){const{unnecessary_cookies_disabled:unnecessary_cookies_disabled,has_accepted_cookies:has_accepted_cookies,settings:settings,cookies:cookies,routes:routes,base_url:base_url,nonces:nonces}=gh;const{tracking:tracking}=routes;const{_wprest:_wprest}=nonces;const{consent_cookie_name:consent_cookie_name="viewed_cookie_policy",consent_cookie_value:consent_cookie_value="yes"}=settings;const{tracking:tracking_cookie,lead_source:lead_source,form_impressions:form_impressions,page_visits:page_visits}=cookies;function apiPost(url="",data={},opts={}){return fetch(url,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":_wprest},body:JSON.stringify(data),...opts}).then((r=>r.json()))}const DURATION={HOUR:60*60*1e3,MINUTE:60*1e3,DAY:24*60*60*1e3};const setCookie=(cname,cvalue,duration)=>{var d=new Date;d.setTime(d.getTime()+duration);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"};const getCookie=(cname,none=null)=>{var name=cname+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1)}if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}return none};const defaultPageTracking={pages:[],pagesAndTimes:[]};const getVisitedPages=()=>JSON.parse(getCookie(page_visits,JSON.stringify(defaultPageTracking)));const rememberPageVisit=(wasTracked=false)=>{if(unnecessary_cookies_disabled){return}const url=new URL(window.location.href);const pagesVisited=getVisitedPages();pagesVisited.pages.push(url.pathname);pagesVisited.pagesAndTimes.push({page:url.href,time:Date.now()/1e3,tracked:wasTracked});setCookie(page_visits,JSON.stringify(pagesVisited),DURATION.HOUR)};gh={...gh,previousFormImpressions:[],trackingFlag:false,pageView(){const url=new URL(window.location.href);if(!unnecessary_cookies_disabled){if(getVisitedPages().pages.includes(url.pathname)){return}}if(this.isLoggedIn||this.hasContactTrackingCookie){apiPost(tracking+"/pages/",{ref:url.href});rememberPageVisit(true)}else{rememberPageVisit(false)}},logFormImpressions(){var self=this;var forms=document.querySelectorAll(".gh-form");forms.forEach((function(form,i){var fId=form.querySelector('input[name="gh_submit_form"]').value;self.formImpression(fId)}))},formImpression(id){if(!id||this.previousFormImpressions.indexOf(id)!==-1){return}apiPost(tracking+"/forms/",{ref:window.location.href,form_id:id}).then((()=>{this.previousFormImpressions.push(id);setCookie(form_impressions,this.previousFormImpressions.join(),3*DURATION.DAY)}))},init(){this.hasContactTrackingCookie=getCookie(tracking_cookie)!==null;this.isLoggedIn=document.body.classList.contains("logged-in");this.has_accepted_cookies=has_accepted_cookies;if(!has_accepted_cookies&&!this.checkCookieConsent()){document.addEventListener("click",(()=>{setTimeout((()=>{this.onCookiesAccept()}),100)}));return}this.doTracking()},doTracking(){if(this.initFlag){return}this.initFlag=true;if(!unnecessary_cookies_disabled){var referer=getCookie(lead_source);if(!referer){setCookie(lead_source,document.referrer,3*DURATION.DAY)}this.previousFormImpressions=getCookie(form_impressions,"").split(",");this.logFormImpressions()}this.pageView()},onCookiesAccept(){if(this.initFlag){return}this.has_accepted_cookies=this.checkCookieConsent();if(this.has_accepted_cookies){this.doTracking()}},checkCookieConsent(){return getCookie(consent_cookie_name||"viewed_cookie_policy")===(consent_cookie_value||"yes")}};window.addEventListener("load",(()=>{gh.init()}))})(Groundhogg);