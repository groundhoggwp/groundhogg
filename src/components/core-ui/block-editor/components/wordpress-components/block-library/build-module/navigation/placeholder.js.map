{"version":3,"sources":["@wordpress/block-library/src/navigation/placeholder.js"],"names":["some","classnames","createBlock","parse","Button","CustomSelectControl","Spinner","Placeholder","useSelect","forwardRef","useCallback","useMemo","useState","useEffect","__","navigation","icon","createDataTree","CREATE_EMPTY_OPTION_VALUE","CREATE_FROM_PAGES_OPTION_VALUE","getPlaceholderInstructions","hasMenus","hasPages","getSelectedMenu","selectedCreateOption","optionId","id","undefined","Number","isInteger","mapMenuItemsToBlocks","menuItems","map","menuItem","type","content","raw","block","attributes","label","title","rendered","opensInNewTab","target","url","description","xfn","length","rel","join","classes","className","innerBlocks","children","convertMenuItemsToBlocks","menuTree","convertPagesToBlocks","pages","link","NavigationPlaceholder","ref","onCreate","setSelectedCreateOption","isCreatingFromMenu","setIsCreatingFromMenu","select","getEntityRecords","getMenus","getMenuItems","isResolving","hasFinishedResolution","pagesParameters","parent","order","orderby","menusParameters","per_page","selectedMenu","hasSelectedMenu","menuItemsParameters","menus","isResolvingPages","hasResolvedPages","isResolvingMenus","hasResolvedMenus","hasResolvedMenuItems","isLoading","createOptions","name","createFromMenu","blocks","selectNavigationBlock","onCreateButtonClick","key","selectedItem","option"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { some } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { createBlock, parse } from '@wordpress/blocks';\nimport {\n\tButton,\n\tCustomSelectControl,\n\tSpinner,\n\tPlaceholder,\n} from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\nimport {\n\tforwardRef,\n\tuseCallback,\n\tuseMemo,\n\tuseState,\n\tuseEffect,\n} from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { navigation as icon } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport createDataTree from './create-data-tree';\n\nconst CREATE_EMPTY_OPTION_VALUE = '__CREATE_EMPTY__';\nconst CREATE_FROM_PAGES_OPTION_VALUE = '__CREATE_FROM_PAGES__';\n\n/**\n * Get instruction text for the Placeholder component.\n *\n * @param {boolean} hasMenus Flag that indicates if there are menus.\n * @param {boolean} hasPages Flag that indicates if there are pages.\n *\n * @return {string} Text to display as the placeholder instructions.\n */\nfunction getPlaceholderInstructions( hasMenus, hasPages ) {\n\tif ( hasMenus && hasPages ) {\n\t\treturn __(\n\t\t\t'Use an existing menu here, include all top-level pages, or add an empty Navigation block.'\n\t\t);\n\t} else if ( hasMenus && ! hasPages ) {\n\t\treturn __(\n\t\t\t'Use an existing menu here, or add an empty Navigation block.'\n\t\t);\n\t} else if ( ! hasMenus && hasPages ) {\n\t\treturn __(\n\t\t\t'Include all existing pages here, or add an empty Navigation block.'\n\t\t);\n\t}\n\n\treturn __( 'Create an empty navigation.' );\n}\n\n/**\n * Return the menu id if the user has one selected.\n *\n * @param {Object} selectedCreateOption An object containing details of\n *                                      the selected create option.\n *\n * @return {number|undefined} The menu id.\n */\nfunction getSelectedMenu( selectedCreateOption ) {\n\tconst optionId = selectedCreateOption?.id;\n\treturn optionId !== undefined && Number.isInteger( optionId )\n\t\t? optionId\n\t\t: undefined;\n}\n\n/**\n * A recursive function that maps menu item nodes to blocks.\n *\n * @param {Object[]} menuItems An array of menu items.\n * @return {WPBlock[]} An array of blocks.\n */\nfunction mapMenuItemsToBlocks( menuItems ) {\n\treturn menuItems.map( ( menuItem ) => {\n\t\tif ( menuItem.type === 'block' ) {\n\t\t\tconst [ block ] = parse( menuItem.content.raw );\n\n\t\t\tif ( ! block ) {\n\t\t\t\treturn createBlock( 'core/freeform', {\n\t\t\t\t\tcontent: menuItem.content,\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn block;\n\t\t}\n\n\t\tconst attributes = {\n\t\t\tlabel: ! menuItem.title.rendered\n\t\t\t\t? __( '(no title)' )\n\t\t\t\t: menuItem.title.rendered,\n\t\t\topensInNewTab: menuItem.target === '_blank',\n\t\t};\n\n\t\tif ( menuItem.url ) {\n\t\t\tattributes.url = menuItem.url;\n\t\t}\n\n\t\tif ( menuItem.description ) {\n\t\t\tattributes.description = menuItem.description;\n\t\t}\n\n\t\tif ( menuItem.xfn?.length && some( menuItem.xfn ) ) {\n\t\t\tattributes.rel = menuItem.xfn.join( ' ' );\n\t\t}\n\n\t\tif ( menuItem.classes?.length && some( menuItem.classes ) ) {\n\t\t\tattributes.className = menuItem.classes.join( ' ' );\n\t\t}\n\n\t\tconst innerBlocks = menuItem.children?.length\n\t\t\t? mapMenuItemsToBlocks( menuItem.children )\n\t\t\t: [];\n\n\t\treturn createBlock( 'core/navigation-link', attributes, innerBlocks );\n\t} );\n}\n\n/**\n * Convert a flat menu item structure to a nested blocks structure.\n *\n * @param {Object[]} menuItems An array of menu items.\n *\n * @return {WPBlock[]} An array of blocks.\n */\nfunction convertMenuItemsToBlocks( menuItems ) {\n\tif ( ! menuItems ) {\n\t\treturn null;\n\t}\n\n\tconst menuTree = createDataTree( menuItems );\n\treturn mapMenuItemsToBlocks( menuTree );\n}\n\n/**\n * Convert pages to blocks.\n *\n * @param {Object[]} pages An array of pages.\n *\n * @return {WPBlock[]} An array of blocks.\n */\nfunction convertPagesToBlocks( pages ) {\n\tif ( ! pages ) {\n\t\treturn null;\n\t}\n\n\treturn pages.map( ( { title, type, link: url, id } ) =>\n\t\tcreateBlock( 'core/navigation-link', {\n\t\t\ttype,\n\t\t\tid,\n\t\t\turl,\n\t\t\tlabel: ! title.rendered ? __( '(no title)' ) : title.rendered,\n\t\t\topensInNewTab: false,\n\t\t} )\n\t);\n}\n\nfunction NavigationPlaceholder( { onCreate }, ref ) {\n\tconst [ selectedCreateOption, setSelectedCreateOption ] = useState();\n\n\tconst [ isCreatingFromMenu, setIsCreatingFromMenu ] = useState( false );\n\n\tconst {\n\t\tpages,\n\t\tisResolvingPages,\n\t\thasResolvedPages,\n\t\tmenus,\n\t\tisResolvingMenus,\n\t\thasResolvedMenus,\n\t\tmenuItems,\n\t\thasResolvedMenuItems,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetEntityRecords,\n\t\t\t\tgetMenus,\n\t\t\t\tgetMenuItems,\n\t\t\t\tisResolving,\n\t\t\t\thasFinishedResolution,\n\t\t\t} = select( 'core' );\n\t\t\tconst pagesParameters = [\n\t\t\t\t'postType',\n\t\t\t\t'page',\n\t\t\t\t{\n\t\t\t\t\tparent: 0,\n\t\t\t\t\torder: 'asc',\n\t\t\t\t\torderby: 'id',\n\t\t\t\t},\n\t\t\t];\n\t\t\tconst menusParameters = [ { per_page: -1 } ];\n\t\t\tconst selectedMenu = getSelectedMenu( selectedCreateOption );\n\t\t\tconst hasSelectedMenu = selectedMenu !== undefined;\n\t\t\tconst menuItemsParameters = hasSelectedMenu\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenus: selectedMenu,\n\t\t\t\t\t\t\tper_page: -1,\n\t\t\t\t\t\t},\n\t\t\t\t  ]\n\t\t\t\t: undefined;\n\n\t\t\treturn {\n\t\t\t\tpages: getEntityRecords( ...pagesParameters ),\n\t\t\t\tisResolvingPages: isResolving(\n\t\t\t\t\t'getEntityRecords',\n\t\t\t\t\tpagesParameters\n\t\t\t\t),\n\t\t\t\thasResolvedPages: hasFinishedResolution(\n\t\t\t\t\t'getEntityRecords',\n\t\t\t\t\tpagesParameters\n\t\t\t\t),\n\t\t\t\tmenus: getMenus( ...menusParameters ),\n\t\t\t\tisResolvingMenus: isResolving( 'getMenus', menusParameters ),\n\t\t\t\thasResolvedMenus: hasFinishedResolution(\n\t\t\t\t\t'getMenus',\n\t\t\t\t\tmenusParameters\n\t\t\t\t),\n\t\t\t\tmenuItems: hasSelectedMenu\n\t\t\t\t\t? getMenuItems( ...menuItemsParameters )\n\t\t\t\t\t: undefined,\n\t\t\t\thasResolvedMenuItems: hasSelectedMenu\n\t\t\t\t\t? hasFinishedResolution(\n\t\t\t\t\t\t\t'getMenuItems',\n\t\t\t\t\t\t\tmenuItemsParameters\n\t\t\t\t\t  )\n\t\t\t\t\t: false,\n\t\t\t};\n\t\t},\n\t\t[ selectedCreateOption ]\n\t);\n\n\tconst hasPages = !! ( hasResolvedPages && pages?.length );\n\tconst hasMenus = !! ( hasResolvedMenus && menus?.length );\n\tconst isLoading = isResolvingPages || isResolvingMenus;\n\n\tconst createOptions = useMemo(\n\t\t() => [\n\t\t\t...( hasMenus ? menus : [] ),\n\t\t\t{\n\t\t\t\tid: CREATE_EMPTY_OPTION_VALUE,\n\t\t\t\tname: __( 'Create empty Navigation' ),\n\t\t\t\tclassName: 'is-create-empty-option',\n\t\t\t},\n\t\t\t...( hasPages\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: CREATE_FROM_PAGES_OPTION_VALUE,\n\t\t\t\t\t\t\tname: __( 'Create from all top-level pages' ),\n\t\t\t\t\t\t},\n\t\t\t\t  ]\n\t\t\t\t: [] ),\n\t\t],\n\t\t[ menus, hasMenus, hasPages ]\n\t);\n\n\tconst createFromMenu = useCallback( () => {\n\t\t// If an empty menu was selected, create an empty block.\n\t\tif ( ! menuItems.length ) {\n\t\t\tonCreate( [] );\n\t\t\treturn;\n\t\t}\n\n\t\tconst blocks = convertMenuItemsToBlocks( menuItems );\n\t\tconst selectNavigationBlock = true;\n\t\tonCreate( blocks, selectNavigationBlock );\n\t} );\n\n\tconst onCreateButtonClick = useCallback( () => {\n\t\tif ( ! selectedCreateOption ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { key } = selectedCreateOption;\n\t\tswitch ( key ) {\n\t\t\tcase CREATE_EMPTY_OPTION_VALUE: {\n\t\t\t\tonCreate( [] );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase CREATE_FROM_PAGES_OPTION_VALUE: {\n\t\t\t\tconst blocks = convertPagesToBlocks( pages );\n\t\t\t\tconst selectNavigationBlock = true;\n\t\t\t\tonCreate( blocks, selectNavigationBlock );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// The default case indicates that a menu was selected.\n\t\t\tdefault:\n\t\t\t\t// If we have menu items, create the block right away.\n\t\t\t\tif ( hasResolvedMenuItems ) {\n\t\t\t\t\tcreateFromMenu();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Otherwise, create the block when resolution finishes.\n\t\t\t\tsetIsCreatingFromMenu( true );\n\t\t}\n\t} );\n\n\tuseEffect( () => {\n\t\t// If the user selected a menu but we had to wait for menu items to\n\t\t// finish resolving, then create the block once resolution finishes.\n\t\tif ( isCreatingFromMenu && hasResolvedMenuItems ) {\n\t\t\tcreateFromMenu();\n\t\t\tsetIsCreatingFromMenu( false );\n\t\t}\n\t}, [ isCreatingFromMenu, hasResolvedMenuItems ] );\n\n\tif ( hasMenus && ! selectedCreateOption ) {\n\t\tsetSelectedCreateOption( createOptions[ 0 ] );\n\t}\n\n\treturn (\n\t\t<Placeholder\n\t\t\tclassName=\"wp-block-navigation-placeholder\"\n\t\t\ticon={ icon }\n\t\t\tlabel={ __( 'Navigation' ) }\n\t\t>\n\t\t\t{ isLoading && (\n\t\t\t\t<div ref={ ref }>\n\t\t\t\t\t<Spinner /> { __( 'Loadingâ€¦' ) }\n\t\t\t\t</div>\n\t\t\t) }\n\t\t\t{ ! isLoading && (\n\t\t\t\t<div\n\t\t\t\t\tref={ ref }\n\t\t\t\t\tclassName=\"wp-block-navigation-placeholder__actions\"\n\t\t\t\t>\n\t\t\t\t\t<>\n\t\t\t\t\t\t<CustomSelectControl\n\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t'wp-block-navigation-placeholder__select-control',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t'has-menus': hasMenus,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t! isLoading\n\t\t\t\t\t\t\t\t\t? getPlaceholderInstructions(\n\t\t\t\t\t\t\t\t\t\t\thasMenus,\n\t\t\t\t\t\t\t\t\t\t\thasPages\n\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvalue={ selectedCreateOption || createOptions[ 0 ] }\n\t\t\t\t\t\t\tonChange={ ( { selectedItem } ) => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tselectedItem?.key === selectedCreateOption\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsetSelectedCreateOption( selectedItem );\n\t\t\t\t\t\t\t\tsetIsCreatingFromMenu( false );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\toptions={ createOptions.map( ( option ) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t...option,\n\t\t\t\t\t\t\t\t\tkey: option.id,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisSecondary\n\t\t\t\t\t\t\tclassName=\"wp-block-navigation-placeholder__button\"\n\t\t\t\t\t\t\tdisabled={ ! selectedCreateOption }\n\t\t\t\t\t\t\tisBusy={ isCreatingFromMenu }\n\t\t\t\t\t\t\tonClick={ onCreateButtonClick }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Create' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</>\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</Placeholder>\n\t);\n}\n\nexport default forwardRef( NavigationPlaceholder );\n"]}