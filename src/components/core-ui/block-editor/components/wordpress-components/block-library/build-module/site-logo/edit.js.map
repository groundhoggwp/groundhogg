{"version":3,"sources":["@wordpress/block-library/src/site-logo/edit.js"],"names":["classnames","includes","pick","isBlobURL","useState","useRef","__","Notice","PanelBody","RangeControl","ResizableBox","Spinner","ToolbarButton","ToolbarGroup","useViewportMatch","BlockControls","BlockIcon","InspectorControls","MediaPlaceholder","MediaReplaceFlow","__experimentalUseBlockWrapperProps","useBlockWrapperProps","useSelect","useDispatch","trash","icon","useClientWidth","MIN_SIZE","ALLOWED_MEDIA_TYPES","ACCEPT_MEDIA_STRING","SiteLogo","alt","attributes","align","width","height","containerRef","isSelected","setAttributes","logoUrl","siteUrl","clientWidth","isLargeViewport","isWideAligned","isResizable","naturalWidth","naturalHeight","setNaturalSize","toggleSelection","classes","select","getSettings","siteEntities","getEditedEntityRecord","title","maxWidth","isRTL","onResizeStart","onResizeStop","img","event","preventDefault","target","imageWidthWithinContainer","exceedMaxWidth","currentWidth","ratio","currentHeight","minWidth","minHeight","maxWidthBuffer","showRightHandle","showLeftHandle","newWidth","Math","min","top","right","bottom","left","direction","elt","delta","parseInt","LogoEdit","className","setLogoUrl","error","setError","ref","siteSettings","mediaItem","getEntityRecord","sitelogo","mediaItemData","url","source_url","alt_text","editEntityRecord","setLogo","newValue","undefined","onSelectLogo","media","id","toString","deleteLogo","onUploadError","message","controls","label","logoImage","mediaPlaceholder","instructions","key","blockWrapperProps"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { includes, pick } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { isBlobURL } from '@wordpress/blob';\nimport { useState, useRef } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tNotice,\n\tPanelBody,\n\tRangeControl,\n\tResizableBox,\n\tSpinner,\n\tToolbarButton,\n\tToolbarGroup,\n} from '@wordpress/components';\nimport { useViewportMatch } from '@wordpress/compose';\nimport {\n\tBlockControls,\n\tBlockIcon,\n\tInspectorControls,\n\tMediaPlaceholder,\n\tMediaReplaceFlow,\n\t__experimentalUseBlockWrapperProps as useBlockWrapperProps,\n} from '@wordpress/block-editor';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { trash } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport icon from './icon';\nimport useClientWidth from '../image/use-client-width';\n\n/**\n * Module constants\n */\nimport { MIN_SIZE } from '../image/constants';\n\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\nconst ACCEPT_MEDIA_STRING = 'image/*';\n\nconst SiteLogo = ( {\n\talt,\n\tattributes: { align, width, height },\n\tcontainerRef,\n\tisSelected,\n\tsetAttributes,\n\tlogoUrl,\n\tsiteUrl,\n} ) => {\n\tconst clientWidth = useClientWidth( containerRef, [ align ] );\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst isWideAligned = includes( [ 'wide', 'full' ], align );\n\tconst isResizable = ! isWideAligned && isLargeViewport;\n\tconst [ { naturalWidth, naturalHeight }, setNaturalSize ] = useState( {} );\n\tconst { toggleSelection } = useDispatch( 'core/block-editor' );\n\tconst classes = classnames( {\n\t\t'is-transient': isBlobURL( logoUrl ),\n\t} );\n\tconst { maxWidth, isRTL, title } = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( 'core/block-editor' );\n\t\tconst siteEntities = select( 'core' ).getEditedEntityRecord(\n\t\t\t'root',\n\t\t\t'site'\n\t\t);\n\t\treturn {\n\t\t\ttitle: siteEntities.title,\n\t\t\t...pick( getSettings(), [ 'imageSizes', 'isRTL', 'maxWidth' ] ),\n\t\t};\n\t} );\n\n\tfunction onResizeStart() {\n\t\ttoggleSelection( false );\n\t}\n\n\tfunction onResizeStop() {\n\t\ttoggleSelection( true );\n\t}\n\n\tconst img = (\n\t\t// Disable reason: Image itself is not meant to be interactive, but\n\t\t// should direct focus to block.\n\t\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions, jsx-a11y/click-events-have-key-events */\n\t\t<a\n\t\t\thref={ siteUrl }\n\t\t\tclassName={ classes }\n\t\t\trel=\"home\"\n\t\t\ttitle={ title }\n\t\t\tonClick={ ( event ) => event.preventDefault() }\n\t\t>\n\t\t\t<span className=\"custom-logo-link\">\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"custom-logo\"\n\t\t\t\t\tsrc={ logoUrl }\n\t\t\t\t\talt={ alt }\n\t\t\t\t\tonLoad={ ( event ) => {\n\t\t\t\t\t\tsetNaturalSize(\n\t\t\t\t\t\t\tpick( event.target, [\n\t\t\t\t\t\t\t\t'naturalWidth',\n\t\t\t\t\t\t\t\t'naturalHeight',\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</span>\n\t\t</a>\n\t\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions, jsx-a11y/click-events-have-key-events */\n\t);\n\n\tlet imageWidthWithinContainer;\n\n\tif ( clientWidth && naturalWidth && naturalHeight ) {\n\t\tconst exceedMaxWidth = naturalWidth > clientWidth;\n\t\timageWidthWithinContainer = exceedMaxWidth ? clientWidth : naturalWidth;\n\t}\n\n\tif ( ! isResizable || ! imageWidthWithinContainer ) {\n\t\treturn <div style={ { width, height } }>{ img }</div>;\n\t}\n\n\tconst currentWidth = width || imageWidthWithinContainer;\n\tconst ratio = naturalWidth / naturalHeight;\n\tconst currentHeight = currentWidth / ratio;\n\tconst minWidth = naturalWidth < naturalHeight ? MIN_SIZE : MIN_SIZE * ratio;\n\tconst minHeight =\n\t\tnaturalHeight < naturalWidth ? MIN_SIZE : MIN_SIZE / ratio;\n\n\t// With the current implementation of ResizableBox, an image needs an\n\t// explicit pixel value for the max-width. In absence of being able to\n\t// set the content-width, this max-width is currently dictated by the\n\t// vanilla editor style. The following variable adds a buffer to this\n\t// vanilla style, so 3rd party themes have some wiggleroom. This does,\n\t// in most cases, allow you to scale the image beyond the width of the\n\t// main column, though not infinitely.\n\t// @todo It would be good to revisit this once a content-width variable\n\t// becomes available.\n\tconst maxWidthBuffer = maxWidth * 2.5;\n\n\tlet showRightHandle = false;\n\tlet showLeftHandle = false;\n\n\t/* eslint-disable no-lonely-if */\n\t// See https://github.com/WordPress/gutenberg/issues/7584.\n\tif ( align === 'center' ) {\n\t\t// When the image is centered, show both handles.\n\t\tshowRightHandle = true;\n\t\tshowLeftHandle = true;\n\t} else if ( isRTL ) {\n\t\t// In RTL mode the image is on the right by default.\n\t\t// Show the right handle and hide the left handle only when it is\n\t\t// aligned left. Otherwise always show the left handle.\n\t\tif ( align === 'left' ) {\n\t\t\tshowRightHandle = true;\n\t\t} else {\n\t\t\tshowLeftHandle = true;\n\t\t}\n\t} else {\n\t\t// Show the left handle and hide the right handle only when the\n\t\t// image is aligned right. Otherwise always show the right handle.\n\t\tif ( align === 'right' ) {\n\t\t\tshowLeftHandle = true;\n\t\t} else {\n\t\t\tshowRightHandle = true;\n\t\t}\n\t}\n\t/* eslint-enable no-lonely-if */\n\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Site Logo Settings' ) }>\n\t\t\t\t\t<RangeControl\n\t\t\t\t\t\tlabel={ __( 'Image width' ) }\n\t\t\t\t\t\tonChange={ ( newWidth ) =>\n\t\t\t\t\t\t\tsetAttributes( { width: newWidth } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmin={ minWidth }\n\t\t\t\t\t\tmax={ maxWidthBuffer }\n\t\t\t\t\t\tinitialPosition={ Math.min(\n\t\t\t\t\t\t\tnaturalWidth,\n\t\t\t\t\t\t\tmaxWidthBuffer\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tvalue={ width || '' }\n\t\t\t\t\t\tdisabled={ ! isResizable }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<ResizableBox\n\t\t\t\tsize={ { width, height } }\n\t\t\t\tshowHandle={ isSelected }\n\t\t\t\tminWidth={ minWidth }\n\t\t\t\tmaxWidth={ maxWidthBuffer }\n\t\t\t\tminHeight={ minHeight }\n\t\t\t\tmaxHeight={ maxWidthBuffer / ratio }\n\t\t\t\tlockAspectRatio\n\t\t\t\tenable={ {\n\t\t\t\t\ttop: false,\n\t\t\t\t\tright: showRightHandle,\n\t\t\t\t\tbottom: true,\n\t\t\t\t\tleft: showLeftHandle,\n\t\t\t\t} }\n\t\t\t\tonResizeStart={ onResizeStart }\n\t\t\t\tonResizeStop={ ( event, direction, elt, delta ) => {\n\t\t\t\t\tonResizeStop();\n\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\twidth: parseInt( currentWidth + delta.width, 10 ),\n\t\t\t\t\t\theight: parseInt( currentHeight + delta.height, 10 ),\n\t\t\t\t\t} );\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ img }\n\t\t\t</ResizableBox>\n\t\t</>\n\t);\n};\n\nexport default function LogoEdit( {\n\tattributes,\n\tclassName,\n\tsetAttributes,\n\tisSelected,\n} ) {\n\tconst { width } = attributes;\n\tconst [ logoUrl, setLogoUrl ] = useState();\n\tconst [ error, setError ] = useState();\n\tconst ref = useRef();\n\tconst { mediaItemData, sitelogo, url } = useSelect( ( select ) => {\n\t\tconst siteSettings = select( 'core' ).getEditedEntityRecord(\n\t\t\t'root',\n\t\t\t'site'\n\t\t);\n\t\tconst mediaItem = select( 'core' ).getEntityRecord(\n\t\t\t'root',\n\t\t\t'media',\n\t\t\tsiteSettings.sitelogo\n\t\t);\n\t\treturn {\n\t\t\tmediaItemData: mediaItem && {\n\t\t\t\turl: mediaItem.source_url,\n\t\t\t\talt: mediaItem.alt_text,\n\t\t\t},\n\t\t\tsitelogo: siteSettings.sitelogo,\n\t\t\turl: siteSettings.url,\n\t\t};\n\t}, [] );\n\n\tconst { editEntityRecord } = useDispatch( 'core' );\n\tconst setLogo = ( newValue ) =>\n\t\teditEntityRecord( 'root', 'site', undefined, {\n\t\t\tsitelogo: newValue,\n\t\t} );\n\n\tlet alt = null;\n\tif ( mediaItemData ) {\n\t\talt = mediaItemData.alt;\n\t\tif ( logoUrl !== mediaItemData.url ) {\n\t\t\tsetLogoUrl( mediaItemData.url );\n\t\t}\n\t}\n\n\tconst onSelectLogo = ( media ) => {\n\t\tif ( ! media ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! media.id && media.url ) {\n\t\t\t// This is a temporary blob image\n\t\t\tsetLogo( '' );\n\t\t\tsetError();\n\t\t\tsetLogoUrl( media.url );\n\t\t\treturn;\n\t\t}\n\n\t\tsetLogo( media.id.toString() );\n\t};\n\n\tconst deleteLogo = () => {\n\t\tsetLogo( '' );\n\t\tsetLogoUrl( '' );\n\t};\n\n\tconst onUploadError = ( message ) => {\n\t\tsetError( message[ 2 ] ? message[ 2 ] : null );\n\t};\n\n\tconst controls = (\n\t\t<BlockControls>\n\t\t\t<ToolbarGroup>\n\t\t\t\t{ logoUrl && (\n\t\t\t\t\t<MediaReplaceFlow\n\t\t\t\t\t\tmediaURL={ logoUrl }\n\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\taccept={ ACCEPT_MEDIA_STRING }\n\t\t\t\t\t\tonSelect={ onSelectLogo }\n\t\t\t\t\t\tonError={ onUploadError }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ !! logoUrl && (\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\ticon={ trash }\n\t\t\t\t\t\tonClick={ () => deleteLogo() }\n\t\t\t\t\t\tlabel={ __( 'Delete Site Logo' ) }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</ToolbarGroup>\n\t\t</BlockControls>\n\t);\n\n\tconst label = __( 'Site Logo' );\n\tlet logoImage;\n\tif ( sitelogo === undefined ) {\n\t\tlogoImage = <Spinner />;\n\t}\n\n\tif ( !! logoUrl ) {\n\t\tlogoImage = (\n\t\t\t<SiteLogo\n\t\t\t\talt={ alt }\n\t\t\t\tattributes={ attributes }\n\t\t\t\tclassName={ className }\n\t\t\t\tcontainerRef={ ref }\n\t\t\t\tisSelected={ isSelected }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\tlogoUrl={ logoUrl }\n\t\t\t\tsiteUrl={ url }\n\t\t\t/>\n\t\t);\n\t}\n\n\tconst mediaPlaceholder = (\n\t\t<MediaPlaceholder\n\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\tlabels={ {\n\t\t\t\ttitle: label,\n\t\t\t\tinstructions: __(\n\t\t\t\t\t'Upload an image, or pick one from your media library, to be your site logo'\n\t\t\t\t),\n\t\t\t} }\n\t\t\tonSelect={ onSelectLogo }\n\t\t\taccept={ ACCEPT_MEDIA_STRING }\n\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\tmediaPreview={ logoImage }\n\t\t\tnotices={\n\t\t\t\terror && (\n\t\t\t\t\t<Notice status=\"error\" isDismissible={ false }>\n\t\t\t\t\t\t{ error }\n\t\t\t\t\t</Notice>\n\t\t\t\t)\n\t\t\t}\n\t\t\tonError={ onUploadError }\n\t\t/>\n\t);\n\n\tconst classes = classnames( className, {\n\t\t'is-resized': !! width,\n\t\t'is-focused': isSelected,\n\t} );\n\n\tconst key = !! logoUrl;\n\n\tconst blockWrapperProps = useBlockWrapperProps( {\n\t\tref,\n\t\tclassName: classes,\n\t\tkey,\n\t} );\n\n\treturn (\n\t\t<div { ...blockWrapperProps }>\n\t\t\t{ controls }\n\t\t\t{ logoUrl && logoImage }\n\t\t\t{ ! logoUrl && mediaPlaceholder }\n\t\t</div>\n\t);\n}\n"]}