{"version":3,"sources":["@wordpress/block-library/src/post-date/edit.js"],"names":["PostDateEdit","attributes","context","setAttributes","textAlign","format","postId","postType","siteFormat","date","setDate","isPickerOpen","setIsPickerOpen","settings","is12Hour","test","formats","time","toLowerCase","replace","split","reverse","join","formatOptions","Object","values","map","formatOption","key","name","resolvedFormat","blockWrapperProps","className","nextAlign","edit","_isPickerOpen","selectedItem","find","option","bind"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useEntityProp } from '@wordpress/core-data';\nimport { useState } from '@wordpress/element';\nimport { __experimentalGetSettings, dateI18n } from '@wordpress/date';\nimport {\n\tAlignmentToolbar,\n\tBlockControls,\n\tInspectorControls,\n\t__experimentalUseBlockWrapperProps as useBlockWrapperProps,\n} from '@wordpress/block-editor';\nimport {\n\tToolbarGroup,\n\tToolbarButton,\n\tPopover,\n\tDateTimePicker,\n\tPanelBody,\n\tCustomSelectControl,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { edit } from '@wordpress/icons';\n\nexport default function PostDateEdit( { attributes, context, setAttributes } ) {\n\tconst { textAlign, format } = attributes;\n\tconst { postId, postType } = context;\n\n\tconst [ siteFormat ] = useEntityProp( 'root', 'site', 'date_format' );\n\tconst [ date, setDate ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'date',\n\t\tpostId\n\t);\n\tconst [ isPickerOpen, setIsPickerOpen ] = useState( false );\n\tconst settings = __experimentalGetSettings();\n\t// To know if the current time format is a 12 hour time, look for \"a\".\n\t// Also make sure this \"a\" is not escaped by a \"/\".\n\tconst is12Hour = /a(?!\\\\)/i.test(\n\t\tsettings.formats.time\n\t\t\t.toLowerCase() // Test only for the lower case \"a\".\n\t\t\t.replace( /\\\\\\\\/g, '' ) // Replace \"//\" with empty strings.\n\t\t\t.split( '' )\n\t\t\t.reverse()\n\t\t\t.join( '' ) // Reverse the string and test for \"a\" not followed by a slash.\n\t);\n\tconst formatOptions = Object.values( settings.formats ).map(\n\t\t( formatOption ) => ( {\n\t\t\tkey: formatOption,\n\t\t\tname: dateI18n( formatOption, date ),\n\t\t} )\n\t);\n\tconst resolvedFormat = format || siteFormat || settings.formats.date;\n\tconst blockWrapperProps = useBlockWrapperProps( {\n\t\tclassName: classnames( {\n\t\t\t[ `has-text-align-${ textAlign }` ]: textAlign,\n\t\t} ),\n\t} );\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t<AlignmentToolbar\n\t\t\t\t\tvalue={ textAlign }\n\t\t\t\t\tonChange={ ( nextAlign ) => {\n\t\t\t\t\t\tsetAttributes( { textAlign: nextAlign } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\n\t\t\t\t{ date && (\n\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\ticon={ edit }\n\t\t\t\t\t\t\ttitle={ __( 'Change Date' ) }\n\t\t\t\t\t\t\tonClick={ () =>\n\t\t\t\t\t\t\t\tsetIsPickerOpen(\n\t\t\t\t\t\t\t\t\t( _isPickerOpen ) => ! _isPickerOpen\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t) }\n\t\t\t</BlockControls>\n\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Format settings' ) }>\n\t\t\t\t\t<CustomSelectControl\n\t\t\t\t\t\thideLabelFromVision\n\t\t\t\t\t\tlabel={ __( 'Date Format' ) }\n\t\t\t\t\t\toptions={ formatOptions }\n\t\t\t\t\t\tonChange={ ( { selectedItem } ) =>\n\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\tformat: selectedItem.key,\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue={ formatOptions.find(\n\t\t\t\t\t\t\t( option ) => option.key === resolvedFormat\n\t\t\t\t\t\t) }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\n\t\t\t<div { ...blockWrapperProps }>\n\t\t\t\t{ date && (\n\t\t\t\t\t<time dateTime={ dateI18n( 'c', date ) }>\n\t\t\t\t\t\t{ dateI18n( resolvedFormat, date ) }\n\n\t\t\t\t\t\t{ isPickerOpen && (\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tonClose={ setIsPickerOpen.bind( null, false ) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<DateTimePicker\n\t\t\t\t\t\t\t\t\tcurrentDate={ date }\n\t\t\t\t\t\t\t\t\tonChange={ setDate }\n\t\t\t\t\t\t\t\t\tis12Hour={ is12Hour }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</time>\n\t\t\t\t) }\n\t\t\t\t{ ! date && __( 'No Date' ) }\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"]}