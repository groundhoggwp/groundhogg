{"version":3,"sources":["@wordpress/block-editor/src/components/block-settings-menu/block-settings-dropdown.js"],"names":["castArray","flow","noop","__","_n","DropdownMenu","MenuGroup","MenuItem","ClipboardButton","useSelect","moreVertical","Children","cloneElement","useCallback","serialize","BlockActions","BlockModeToggle","BlockHTMLConvertButton","__experimentalBlockSettingsMenuFirstItem","BlockSettingsMenuControls","POPOVER_PROPS","className","position","isAlternate","BlockSettingsDropdown","clientIds","__experimentalSelectBlock","children","props","blockClientIds","count","length","firstBlockClientId","shortcuts","select","getShortcutRepresentation","duplicate","remove","insertAfter","insertBefore","updateSelection","clientIdsPromise","ids","canDuplicate","canInsertDefaultBlock","isLocked","onDuplicate","onInsertAfter","onInsertBefore","onRemove","onCopy","onMoveTo","blocks","onClose","map","child"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { castArray, flow, noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, _n } from '@wordpress/i18n';\nimport {\n\tDropdownMenu,\n\tMenuGroup,\n\tMenuItem,\n\tClipboardButton,\n} from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\nimport { moreVertical } from '@wordpress/icons';\n\nimport { Children, cloneElement, useCallback } from '@wordpress/element';\nimport { serialize } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport BlockActions from '../block-actions';\nimport BlockModeToggle from './block-mode-toggle';\nimport BlockHTMLConvertButton from './block-html-convert-button';\nimport __experimentalBlockSettingsMenuFirstItem from './block-settings-menu-first-item';\nimport BlockSettingsMenuControls from '../block-settings-menu-controls';\n\nconst POPOVER_PROPS = {\n\tclassName: 'block-editor-block-settings-menu__popover',\n\tposition: 'bottom right',\n\tisAlternate: true,\n};\n\nexport function BlockSettingsDropdown( {\n\tclientIds,\n\t__experimentalSelectBlock,\n\tchildren,\n\t...props\n} ) {\n\tconst blockClientIds = castArray( clientIds );\n\tconst count = blockClientIds.length;\n\tconst firstBlockClientId = blockClientIds[ 0 ];\n\n\tconst shortcuts = useSelect( ( select ) => {\n\t\tconst { getShortcutRepresentation } = select(\n\t\t\t'core/keyboard-shortcuts'\n\t\t);\n\t\treturn {\n\t\t\tduplicate: getShortcutRepresentation(\n\t\t\t\t'core/block-editor/duplicate'\n\t\t\t),\n\t\t\tremove: getShortcutRepresentation( 'core/block-editor/remove' ),\n\t\t\tinsertAfter: getShortcutRepresentation(\n\t\t\t\t'core/block-editor/insert-after'\n\t\t\t),\n\t\t\tinsertBefore: getShortcutRepresentation(\n\t\t\t\t'core/block-editor/insert-before'\n\t\t\t),\n\t\t};\n\t}, [] );\n\n\tconst updateSelection = useCallback(\n\t\t__experimentalSelectBlock\n\t\t\t? async ( clientIdsPromise ) => {\n\t\t\t\t\tconst ids = await clientIdsPromise;\n\t\t\t\t\tif ( ids && ids[ 0 ] ) {\n\t\t\t\t\t\t__experimentalSelectBlock( ids[ 0 ] );\n\t\t\t\t\t}\n\t\t\t  }\n\t\t\t: noop,\n\t\t[ __experimentalSelectBlock ]\n\t);\n\n\treturn (\n\t\t<BlockActions\n\t\t\tclientIds={ clientIds }\n\t\t\t__experimentalUpdateSelection={ ! __experimentalSelectBlock }\n\t\t>\n\t\t\t{ ( {\n\t\t\t\tcanDuplicate,\n\t\t\t\tcanInsertDefaultBlock,\n\t\t\t\tisLocked,\n\t\t\t\tonDuplicate,\n\t\t\t\tonInsertAfter,\n\t\t\t\tonInsertBefore,\n\t\t\t\tonRemove,\n\t\t\t\tonCopy,\n\t\t\t\tonMoveTo,\n\t\t\t\tblocks,\n\t\t\t} ) => (\n\t\t\t\t<DropdownMenu\n\t\t\t\t\ticon={ moreVertical }\n\t\t\t\t\tlabel={ __( 'More options' ) }\n\t\t\t\t\tclassName=\"block-editor-block-settings-menu\"\n\t\t\t\t\tpopoverProps={ POPOVER_PROPS }\n\t\t\t\t\tnoIcons\n\t\t\t\t\t{ ...props }\n\t\t\t\t>\n\t\t\t\t\t{ ( { onClose } ) => (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t\t\t<__experimentalBlockSettingsMenuFirstItem.Slot\n\t\t\t\t\t\t\t\t\tfillProps={ { onClose } }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{ count === 1 && (\n\t\t\t\t\t\t\t\t\t<BlockHTMLConvertButton\n\t\t\t\t\t\t\t\t\t\tclientId={ firstBlockClientId }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t<ClipboardButton\n\t\t\t\t\t\t\t\t\ttext={ () => serialize( blocks ) }\n\t\t\t\t\t\t\t\t\trole=\"menuitem\"\n\t\t\t\t\t\t\t\t\tclassName=\"components-menu-item__button\"\n\t\t\t\t\t\t\t\t\tonCopy={ onCopy }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Copy' ) }\n\t\t\t\t\t\t\t\t</ClipboardButton>\n\t\t\t\t\t\t\t\t{ canDuplicate && (\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tonClick={ flow(\n\t\t\t\t\t\t\t\t\t\t\tonClose,\n\t\t\t\t\t\t\t\t\t\t\tonDuplicate,\n\t\t\t\t\t\t\t\t\t\t\tupdateSelection\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\tshortcut={ shortcuts.duplicate }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Duplicate' ) }\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ canInsertDefaultBlock && (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\t\tonClick={ flow(\n\t\t\t\t\t\t\t\t\t\t\t\tonClose,\n\t\t\t\t\t\t\t\t\t\t\t\tonInsertBefore\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\tshortcut={ shortcuts.insertBefore }\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{ __( 'Insert Before' ) }\n\t\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\t\tonClick={ flow(\n\t\t\t\t\t\t\t\t\t\t\t\tonClose,\n\t\t\t\t\t\t\t\t\t\t\t\tonInsertAfter\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\tshortcut={ shortcuts.insertAfter }\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{ __( 'Insert After' ) }\n\t\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ ! isLocked && (\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tonClick={ flow( onClose, onMoveTo ) }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Move To' ) }\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ count === 1 && (\n\t\t\t\t\t\t\t\t\t<BlockModeToggle\n\t\t\t\t\t\t\t\t\t\tclientId={ firstBlockClientId }\n\t\t\t\t\t\t\t\t\t\tonToggle={ onClose }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t\t<BlockSettingsMenuControls.Slot\n\t\t\t\t\t\t\t\tfillProps={ { onClose } }\n\t\t\t\t\t\t\t\tclientIds={ clientIds }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{ typeof children === 'function'\n\t\t\t\t\t\t\t\t? children( { onClose } )\n\t\t\t\t\t\t\t\t: Children.map( ( child ) =>\n\t\t\t\t\t\t\t\t\t\tcloneElement( child, { onClose } )\n\t\t\t\t\t\t\t\t  ) }\n\t\t\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t\t\t{ ! isLocked && (\n\t\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\t\tonClick={ flow(\n\t\t\t\t\t\t\t\t\t\t\tonClose,\n\t\t\t\t\t\t\t\t\t\t\tonRemove,\n\t\t\t\t\t\t\t\t\t\t\tupdateSelection\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\tshortcut={ shortcuts.remove }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ _n(\n\t\t\t\t\t\t\t\t\t\t\t'Remove block',\n\t\t\t\t\t\t\t\t\t\t\t'Remove blocks',\n\t\t\t\t\t\t\t\t\t\t\tcount\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</DropdownMenu>\n\t\t\t) }\n\t\t</BlockActions>\n\t);\n}\n\nexport default BlockSettingsDropdown;\n"]}