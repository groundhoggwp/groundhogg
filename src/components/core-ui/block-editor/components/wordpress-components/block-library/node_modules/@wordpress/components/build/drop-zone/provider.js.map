{"version":3,"sources":["@wordpress/components/src/drop-zone/provider.js"],"names":["Context","addDropZone","removeDropZone","Provider","Consumer","getDragEventType","dataTransfer","types","isTypeSupportedByDropZone","type","dropZone","onFilesDrop","onHTMLDrop","onDrop","isWithinElementBounds","element","x","y","rect","getBoundingClientRect","bottom","top","left","right","DropZoneProvider","arguments","onDragOver","bind","resetDragState","toggleDraggingOverDocument","dropZones","dropZoneCallbacks","state","hoveredDropZone","isDraggingOverDocument","position","ref","ownerDocument","current","defaultView","addEventListener","removeEventListener","push","dz","cancel","setState","forEach","isDraggingOverElement","event","dragEventType","detail","window","CustomEvent","hoveredDropZones","clientX","clientY","zone","container","isRelative","parentElement","subZone","contains","hoveredDropZoneIndex","indexOf","withPosition","toUpdate","index","isDraggingOverDropZone","newState","preventDefault","files","length","getData","stopPropagation","props","children","Component"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { isEqual, find, some, filter, throttle, includes } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, createContext, createRef } from '@wordpress/element';\nimport isShallowEqual from '@wordpress/is-shallow-equal';\n\nexport const Context = createContext( {\n\taddDropZone: () => {},\n\tremoveDropZone: () => {},\n} );\n\nconst { Provider, Consumer } = Context;\n\nconst getDragEventType = ( { dataTransfer } ) => {\n\tif ( dataTransfer ) {\n\t\t// Use lodash `includes` here as in the Edge browser `types` is implemented\n\t\t// as a DomStringList, whereas in other browsers it's an array. `includes`\n\t\t// happily works with both types.\n\t\tif ( includes( dataTransfer.types, 'Files' ) ) {\n\t\t\treturn 'file';\n\t\t}\n\n\t\tif ( includes( dataTransfer.types, 'text/html' ) ) {\n\t\t\treturn 'html';\n\t\t}\n\t}\n\n\treturn 'default';\n};\n\nconst isTypeSupportedByDropZone = ( type, dropZone ) => {\n\treturn (\n\t\t( type === 'file' && dropZone.onFilesDrop ) ||\n\t\t( type === 'html' && dropZone.onHTMLDrop ) ||\n\t\t( type === 'default' && dropZone.onDrop )\n\t);\n};\n\nconst isWithinElementBounds = ( element, x, y ) => {\n\tconst rect = element.getBoundingClientRect();\n\t/// make sure the rect is a valid rect\n\tif ( rect.bottom === rect.top || rect.left === rect.right ) {\n\t\treturn false;\n\t}\n\n\treturn (\n\t\tx >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom\n\t);\n};\n\nclass DropZoneProvider extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\t// Event listeners\n\t\tthis.onDragOver = this.onDragOver.bind( this );\n\t\tthis.onDrop = this.onDrop.bind( this );\n\t\t// Context methods so this component can receive data from consumers\n\t\tthis.addDropZone = this.addDropZone.bind( this );\n\t\tthis.removeDropZone = this.removeDropZone.bind( this );\n\t\t// Utility methods\n\t\tthis.resetDragState = this.resetDragState.bind( this );\n\t\tthis.toggleDraggingOverDocument = throttle(\n\t\t\tthis.toggleDraggingOverDocument.bind( this ),\n\t\t\t200\n\t\t);\n\n\t\tthis.dropZones = [];\n\t\tthis.dropZoneCallbacks = {\n\t\t\taddDropZone: this.addDropZone,\n\t\t\tremoveDropZone: this.removeDropZone,\n\t\t};\n\t\tthis.state = {\n\t\t\thoveredDropZone: -1,\n\t\t\tisDraggingOverDocument: false,\n\t\t\tposition: null,\n\t\t};\n\t\tthis.ref = createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { ownerDocument } = this.ref.current;\n\t\tconst { defaultView } = ownerDocument;\n\t\tdefaultView.addEventListener( 'dragover', this.onDragOver );\n\t\tdefaultView.addEventListener( 'mouseup', this.resetDragState );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tconst { ownerDocument } = this.ref.current;\n\t\tconst { defaultView } = ownerDocument;\n\t\tdefaultView.removeEventListener( 'dragover', this.onDragOver );\n\t\tdefaultView.removeEventListener( 'mouseup', this.resetDragState );\n\t}\n\n\taddDropZone( dropZone ) {\n\t\tthis.dropZones.push( dropZone );\n\t}\n\n\tremoveDropZone( dropZone ) {\n\t\tthis.dropZones = filter( this.dropZones, ( dz ) => dz !== dropZone );\n\t}\n\n\tresetDragState() {\n\t\t// Avoid throttled drag over handler calls\n\t\tthis.toggleDraggingOverDocument.cancel();\n\n\t\tconst { isDraggingOverDocument, hoveredDropZone } = this.state;\n\t\tif ( ! isDraggingOverDocument && hoveredDropZone === -1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\thoveredDropZone: -1,\n\t\t\tisDraggingOverDocument: false,\n\t\t\tposition: null,\n\t\t} );\n\n\t\tthis.dropZones.forEach( ( dropZone ) =>\n\t\t\tdropZone.setState( {\n\t\t\t\tisDraggingOverDocument: false,\n\t\t\t\tisDraggingOverElement: false,\n\t\t\t\tposition: null,\n\t\t\t\ttype: null,\n\t\t\t} )\n\t\t);\n\t}\n\n\ttoggleDraggingOverDocument( event, dragEventType ) {\n\t\t// In some contexts, it may be necessary to capture and redirect the\n\t\t// drag event (e.g. atop an `iframe`). To accommodate this, you can\n\t\t// create an instance of CustomEvent with the original event specified\n\t\t// as the `detail` property.\n\t\t//\n\t\t// See: https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events\n\t\tconst detail =\n\t\t\twindow.CustomEvent && event instanceof window.CustomEvent\n\t\t\t\t? event.detail\n\t\t\t\t: event;\n\n\t\t// Index of hovered dropzone.\n\t\tconst hoveredDropZones = filter(\n\t\t\tthis.dropZones,\n\t\t\t( dropZone ) =>\n\t\t\t\tisTypeSupportedByDropZone( dragEventType, dropZone ) &&\n\t\t\t\tisWithinElementBounds(\n\t\t\t\t\tdropZone.element.current,\n\t\t\t\t\tdetail.clientX,\n\t\t\t\t\tdetail.clientY\n\t\t\t\t)\n\t\t);\n\n\t\t// Find the leaf dropzone not containing another dropzone\n\t\tconst hoveredDropZone = find( hoveredDropZones, ( zone ) => {\n\t\t\tconst container = zone.isRelative\n\t\t\t\t? zone.element.current.parentElement\n\t\t\t\t: zone.element.current;\n\n\t\t\treturn ! some(\n\t\t\t\thoveredDropZones,\n\t\t\t\t( subZone ) =>\n\t\t\t\t\tsubZone !== zone &&\n\t\t\t\t\tcontainer.contains( subZone.element.current )\n\t\t\t);\n\t\t} );\n\n\t\tconst hoveredDropZoneIndex = this.dropZones.indexOf( hoveredDropZone );\n\n\t\tlet position = null;\n\n\t\tif ( hoveredDropZone && hoveredDropZone.withPosition ) {\n\t\t\tposition = { x: detail.clientX, y: detail.clientY };\n\t\t}\n\n\t\t// Optimisation: Only update the changed dropzones\n\t\tlet toUpdate = [];\n\n\t\tif ( ! this.state.isDraggingOverDocument ) {\n\t\t\ttoUpdate = this.dropZones;\n\t\t} else if ( hoveredDropZoneIndex !== this.state.hoveredDropZone ) {\n\t\t\tif ( this.state.hoveredDropZone !== -1 ) {\n\t\t\t\ttoUpdate.push( this.dropZones[ this.state.hoveredDropZone ] );\n\t\t\t}\n\t\t\tif ( hoveredDropZone ) {\n\t\t\t\ttoUpdate.push( hoveredDropZone );\n\t\t\t}\n\t\t} else if (\n\t\t\thoveredDropZone &&\n\t\t\thoveredDropZoneIndex === this.state.hoveredDropZone &&\n\t\t\t! isEqual( position, this.state.position )\n\t\t) {\n\t\t\ttoUpdate.push( hoveredDropZone );\n\t\t}\n\n\t\t// Notifying the dropzones\n\t\ttoUpdate.forEach( ( dropZone ) => {\n\t\t\tconst index = this.dropZones.indexOf( dropZone );\n\t\t\tconst isDraggingOverDropZone = index === hoveredDropZoneIndex;\n\t\t\tdropZone.setState( {\n\t\t\t\tisDraggingOverDocument: isTypeSupportedByDropZone(\n\t\t\t\t\tdragEventType,\n\t\t\t\t\tdropZone\n\t\t\t\t),\n\t\t\t\tisDraggingOverElement: isDraggingOverDropZone,\n\t\t\t\tposition: isDraggingOverDropZone ? position : null,\n\t\t\t\ttype: isDraggingOverDropZone ? dragEventType : null,\n\t\t\t} );\n\t\t} );\n\n\t\tconst newState = {\n\t\t\tisDraggingOverDocument: true,\n\t\t\thoveredDropZone: hoveredDropZoneIndex,\n\t\t\tposition,\n\t\t};\n\t\tif ( ! isShallowEqual( newState, this.state ) ) {\n\t\t\tthis.setState( newState );\n\t\t}\n\t}\n\n\tonDragOver( event ) {\n\t\tthis.toggleDraggingOverDocument( event, getDragEventType( event ) );\n\t\tevent.preventDefault();\n\t}\n\n\tonDrop( event ) {\n\t\t// This seemingly useless line has been shown to resolve a Safari issue\n\t\t// where files dragged directly from the dock are not recognized\n\t\tevent.dataTransfer && event.dataTransfer.files.length; // eslint-disable-line no-unused-expressions\n\n\t\tconst { position, hoveredDropZone } = this.state;\n\t\tconst dragEventType = getDragEventType( event );\n\t\tconst dropZone = this.dropZones[ hoveredDropZone ];\n\t\tthis.resetDragState();\n\n\t\tif ( dropZone ) {\n\t\t\tswitch ( dragEventType ) {\n\t\t\t\tcase 'file':\n\t\t\t\t\tdropZone.onFilesDrop(\n\t\t\t\t\t\t[ ...event.dataTransfer.files ],\n\t\t\t\t\t\tposition\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'html':\n\t\t\t\t\tdropZone.onHTMLDrop(\n\t\t\t\t\t\tevent.dataTransfer.getData( 'text/html' ),\n\t\t\t\t\t\tposition\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'default':\n\t\t\t\t\tdropZone.onDrop( event, position );\n\t\t\t}\n\t\t}\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tref={ this.ref }\n\t\t\t\tonDrop={ this.onDrop }\n\t\t\t\tclassName=\"components-drop-zone__provider\"\n\t\t\t>\n\t\t\t\t<Provider value={ this.dropZoneCallbacks }>\n\t\t\t\t\t{ this.props.children }\n\t\t\t\t</Provider>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default DropZoneProvider;\nexport { Consumer as DropZoneConsumer };\n"]}