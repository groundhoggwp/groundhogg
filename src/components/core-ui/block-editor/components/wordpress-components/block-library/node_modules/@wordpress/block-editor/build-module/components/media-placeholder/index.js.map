{"version":3,"sources":["@wordpress/block-editor/src/components/media-placeholder/index.js"],"names":["noop","classnames","Button","FormFileUpload","Placeholder","DropZone","withFilters","__","useState","useEffect","useSelect","deprecated","keyboardReturn","MediaUpload","MediaUploadCheck","URLPopover","InsertFromURLPopover","src","onChange","onSubmit","onClose","MediaPlaceholder","value","allowedTypes","className","icon","labels","mediaPreview","notices","isAppender","accept","addToGallery","multiple","dropZoneUIOnly","disableDropZone","disableMediaButtons","onError","onSelect","onCancel","onSelectURL","onDoubleClick","onFilesPreUpload","onHTMLDrop","children","mediaUpload","select","getSettings","setSrc","isURLInputVisible","setIsURLInputVisible","onlyAllowsImages","length","every","allowedType","startsWith","onChangeSrc","event","target","openURLInput","closeURLInput","onSubmitSrc","preventDefault","onFilesUpload","files","setMedia","lastMediaPassed","newMedia","filteredMedia","filter","item","id","some","Number","urlSlug","url","includes","concat","map","media","cutOffIndex","lastIndexOf","slice","filesList","onFileChange","onUpload","renderPlaceholder","content","onClick","instructions","title","undefined","typesAllowed","firstAllowedType","isOneType","isAudio","isImage","isVideo","placeholderClassName","renderDropZone","renderCancelLink","renderUrlSelectionUI","renderMediaUploadChecked","mediaLibraryButton","Array","isArray","open","stopPropagation","openFileDialog","alternative"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tButton,\n\tFormFileUpload,\n\tPlaceholder,\n\tDropZone,\n\twithFilters,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useState, useEffect } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport deprecated from '@wordpress/deprecated';\nimport { keyboardReturn } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport MediaUpload from '../media-upload';\nimport MediaUploadCheck from '../media-upload/check';\nimport URLPopover from '../url-popover';\n\nconst InsertFromURLPopover = ( { src, onChange, onSubmit, onClose } ) => (\n\t<URLPopover onClose={ onClose }>\n\t\t<form\n\t\t\tclassName=\"block-editor-media-placeholder__url-input-form\"\n\t\t\tonSubmit={ onSubmit }\n\t\t>\n\t\t\t<input\n\t\t\t\tclassName=\"block-editor-media-placeholder__url-input-field\"\n\t\t\t\ttype=\"url\"\n\t\t\t\taria-label={ __( 'URL' ) }\n\t\t\t\tplaceholder={ __( 'Paste or type URL' ) }\n\t\t\t\tonChange={ onChange }\n\t\t\t\tvalue={ src }\n\t\t\t/>\n\t\t\t<Button\n\t\t\t\tclassName=\"block-editor-media-placeholder__url-input-submit-button\"\n\t\t\t\ticon={ keyboardReturn }\n\t\t\t\tlabel={ __( 'Apply' ) }\n\t\t\t\ttype=\"submit\"\n\t\t\t/>\n\t\t</form>\n\t</URLPopover>\n);\n\nexport function MediaPlaceholder( {\n\tvalue = {},\n\tallowedTypes,\n\tclassName,\n\ticon,\n\tlabels = {},\n\tmediaPreview,\n\tnotices,\n\tisAppender,\n\taccept,\n\taddToGallery,\n\tmultiple = false,\n\tdropZoneUIOnly,\n\tdisableDropZone,\n\tdisableMediaButtons,\n\tonError,\n\tonSelect,\n\tonCancel,\n\tonSelectURL,\n\tonDoubleClick,\n\tonFilesPreUpload = noop,\n\tonHTMLDrop = noop,\n\tchildren,\n} ) {\n\tconst mediaUpload = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( 'core/block-editor' );\n\t\treturn getSettings().mediaUpload;\n\t}, [] );\n\tconst [ src, setSrc ] = useState( '' );\n\tconst [ isURLInputVisible, setIsURLInputVisible ] = useState( false );\n\n\tuseEffect( () => {\n\t\tsetSrc( value?.src ?? '' );\n\t}, [ value ] );\n\n\tconst onlyAllowsImages = () => {\n\t\tif ( ! allowedTypes || allowedTypes.length === 0 ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn allowedTypes.every(\n\t\t\t( allowedType ) =>\n\t\t\t\tallowedType === 'image' || allowedType.startsWith( 'image/' )\n\t\t);\n\t};\n\n\tconst onChangeSrc = ( event ) => {\n\t\tsetSrc( event.target.value );\n\t};\n\n\tconst openURLInput = () => {\n\t\tsetIsURLInputVisible( true );\n\t};\n\tconst closeURLInput = () => {\n\t\tsetIsURLInputVisible( false );\n\t};\n\n\tconst onSubmitSrc = ( event ) => {\n\t\tevent.preventDefault();\n\t\tif ( src && onSelectURL ) {\n\t\t\tonSelectURL( src );\n\t\t\tcloseURLInput();\n\t\t}\n\t};\n\n\tconst onFilesUpload = ( files ) => {\n\t\tonFilesPreUpload( files );\n\t\tlet setMedia;\n\t\tif ( multiple ) {\n\t\t\tif ( addToGallery ) {\n\t\t\t\t// Since the setMedia function runs multiple times per upload group\n\t\t\t\t// and is passed newMedia containing every item in its group each time, we must\n\t\t\t\t// filter out whatever this upload group had previously returned to the\n\t\t\t\t// gallery before adding and returning the image array with replacement newMedia\n\t\t\t\t// values.\n\n\t\t\t\t// Define an array to store urls from newMedia between subsequent function calls.\n\t\t\t\tlet lastMediaPassed = [];\n\t\t\t\tsetMedia = ( newMedia ) => {\n\t\t\t\t\t// Remove any images this upload group is responsible for (lastMediaPassed).\n\t\t\t\t\t// Their replacements are contained in newMedia.\n\t\t\t\t\tconst filteredMedia = ( value ?? [] ).filter( ( item ) => {\n\t\t\t\t\t\t// If Item has id, only remove it if lastMediaPassed has an item with that id.\n\t\t\t\t\t\tif ( item.id ) {\n\t\t\t\t\t\t\treturn ! lastMediaPassed.some(\n\t\t\t\t\t\t\t\t// Be sure to convert to number for comparison.\n\t\t\t\t\t\t\t\t( { id } ) => Number( id ) === Number( item.id )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Compare transient images via .includes since gallery may append extra info onto the url.\n\t\t\t\t\t\treturn ! lastMediaPassed.some( ( { urlSlug } ) =>\n\t\t\t\t\t\t\titem.url.includes( urlSlug )\n\t\t\t\t\t\t);\n\t\t\t\t\t} );\n\t\t\t\t\t// Return the filtered media array along with newMedia.\n\t\t\t\t\tonSelect( filteredMedia.concat( newMedia ) );\n\t\t\t\t\t// Reset lastMediaPassed and set it with ids and urls from newMedia.\n\t\t\t\t\tlastMediaPassed = newMedia.map( ( media ) => {\n\t\t\t\t\t\t// Add everything up to '.fileType' to compare via .includes.\n\t\t\t\t\t\tconst cutOffIndex = media.url.lastIndexOf( '.' );\n\t\t\t\t\t\tconst urlSlug = media.url.slice( 0, cutOffIndex );\n\t\t\t\t\t\treturn { id: media.id, urlSlug };\n\t\t\t\t\t} );\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tsetMedia = onSelect;\n\t\t\t}\n\t\t} else {\n\t\t\tsetMedia = ( [ media ] ) => onSelect( media );\n\t\t}\n\t\tmediaUpload( {\n\t\t\tallowedTypes,\n\t\t\tfilesList: files,\n\t\t\tonFileChange: setMedia,\n\t\t\tonError,\n\t\t} );\n\t};\n\n\tconst onUpload = ( event ) => {\n\t\tonFilesUpload( event.target.files );\n\t};\n\n\tconst renderPlaceholder = ( content, onClick ) => {\n\t\tlet { instructions, title } = labels;\n\n\t\tif ( ! mediaUpload && ! onSelectURL ) {\n\t\t\tinstructions = __(\n\t\t\t\t'To edit this block, you need permission to upload media.'\n\t\t\t);\n\t\t}\n\n\t\tif ( instructions === undefined || title === undefined ) {\n\t\t\tconst typesAllowed = allowedTypes ?? [];\n\n\t\t\tconst [ firstAllowedType ] = typesAllowed;\n\t\t\tconst isOneType = 1 === typesAllowed.length;\n\t\t\tconst isAudio = isOneType && 'audio' === firstAllowedType;\n\t\t\tconst isImage = isOneType && 'image' === firstAllowedType;\n\t\t\tconst isVideo = isOneType && 'video' === firstAllowedType;\n\n\t\t\tif ( instructions === undefined && mediaUpload ) {\n\t\t\t\tinstructions = __(\n\t\t\t\t\t'Upload a media file or pick one from your media library.'\n\t\t\t\t);\n\n\t\t\t\tif ( isAudio ) {\n\t\t\t\t\tinstructions = __(\n\t\t\t\t\t\t'Upload an audio file, pick one from your media library, or add one with a URL.'\n\t\t\t\t\t);\n\t\t\t\t} else if ( isImage ) {\n\t\t\t\t\tinstructions = __(\n\t\t\t\t\t\t'Upload an image file, pick one from your media library, or add one with a URL.'\n\t\t\t\t\t);\n\t\t\t\t} else if ( isVideo ) {\n\t\t\t\t\tinstructions = __(\n\t\t\t\t\t\t'Upload a video file, pick one from your media library, or add one with a URL.'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( title === undefined ) {\n\t\t\t\ttitle = __( 'Media' );\n\n\t\t\t\tif ( isAudio ) {\n\t\t\t\t\ttitle = __( 'Audio' );\n\t\t\t\t} else if ( isImage ) {\n\t\t\t\t\ttitle = __( 'Image' );\n\t\t\t\t} else if ( isVideo ) {\n\t\t\t\t\ttitle = __( 'Video' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst placeholderClassName = classnames(\n\t\t\t'block-editor-media-placeholder',\n\t\t\tclassName,\n\t\t\t{\n\t\t\t\t'is-appender': isAppender,\n\t\t\t}\n\t\t);\n\n\t\treturn (\n\t\t\t<Placeholder\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ title }\n\t\t\t\tinstructions={ instructions }\n\t\t\t\tclassName={ placeholderClassName }\n\t\t\t\tnotices={ notices }\n\t\t\t\tonClick={ onClick }\n\t\t\t\tonDoubleClick={ onDoubleClick }\n\t\t\t\tpreview={ mediaPreview }\n\t\t\t>\n\t\t\t\t{ content }\n\t\t\t\t{ children }\n\t\t\t</Placeholder>\n\t\t);\n\t};\n\n\tconst renderDropZone = () => {\n\t\tif ( disableDropZone ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<DropZone onFilesDrop={ onFilesUpload } onHTMLDrop={ onHTMLDrop } />\n\t\t);\n\t};\n\n\tconst renderCancelLink = () => {\n\t\treturn (\n\t\t\tonCancel && (\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"block-editor-media-placeholder__cancel-button\"\n\t\t\t\t\ttitle={ __( 'Cancel' ) }\n\t\t\t\t\tisLink\n\t\t\t\t\tonClick={ onCancel }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t</Button>\n\t\t\t)\n\t\t);\n\t};\n\n\tconst renderUrlSelectionUI = () => {\n\t\treturn (\n\t\t\tonSelectURL && (\n\t\t\t\t<div className=\"block-editor-media-placeholder__url-input-container\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"block-editor-media-placeholder__button\"\n\t\t\t\t\t\tonClick={ openURLInput }\n\t\t\t\t\t\tisPressed={ isURLInputVisible }\n\t\t\t\t\t\tisTertiary\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Insert from URL' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t\t{ isURLInputVisible && (\n\t\t\t\t\t\t<InsertFromURLPopover\n\t\t\t\t\t\t\tsrc={ src }\n\t\t\t\t\t\t\tonChange={ onChangeSrc }\n\t\t\t\t\t\t\tonSubmit={ onSubmitSrc }\n\t\t\t\t\t\t\tonClose={ closeURLInput }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t)\n\t\t);\n\t};\n\n\tconst renderMediaUploadChecked = () => {\n\t\tconst mediaLibraryButton = (\n\t\t\t<MediaUpload\n\t\t\t\taddToGallery={ addToGallery }\n\t\t\t\tgallery={ multiple && onlyAllowsImages() }\n\t\t\t\tmultiple={ multiple }\n\t\t\t\tonSelect={ onSelect }\n\t\t\t\tallowedTypes={ allowedTypes }\n\t\t\t\tvalue={\n\t\t\t\t\tArray.isArray( value )\n\t\t\t\t\t\t? value.map( ( { id } ) => id )\n\t\t\t\t\t\t: value.id\n\t\t\t\t}\n\t\t\t\trender={ ( { open } ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisTertiary\n\t\t\t\t\t\t\tonClick={ ( event ) => {\n\t\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\t\topen();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Media Library' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\n\t\tif ( mediaUpload && isAppender ) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t{ renderDropZone() }\n\t\t\t\t\t<FormFileUpload\n\t\t\t\t\t\tonChange={ onUpload }\n\t\t\t\t\t\taccept={ accept }\n\t\t\t\t\t\tmultiple={ multiple }\n\t\t\t\t\t\trender={ ( { openFileDialog } ) => {\n\t\t\t\t\t\t\tconst content = (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t\t\t\t'block-editor-media-placeholder__button',\n\t\t\t\t\t\t\t\t\t\t\t'block-editor-media-placeholder__upload-button'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Upload' ) }\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t{ mediaLibraryButton }\n\t\t\t\t\t\t\t\t\t{ renderUrlSelectionUI() }\n\t\t\t\t\t\t\t\t\t{ renderCancelLink() }\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn renderPlaceholder( content, openFileDialog );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\n\t\tif ( mediaUpload ) {\n\t\t\tconst content = (\n\t\t\t\t<>\n\t\t\t\t\t{ renderDropZone() }\n\t\t\t\t\t<FormFileUpload\n\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t'block-editor-media-placeholder__button',\n\t\t\t\t\t\t\t'block-editor-media-placeholder__upload-button'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonChange={ onUpload }\n\t\t\t\t\t\taccept={ accept }\n\t\t\t\t\t\tmultiple={ multiple }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Upload' ) }\n\t\t\t\t\t</FormFileUpload>\n\t\t\t\t\t{ mediaLibraryButton }\n\t\t\t\t\t{ renderUrlSelectionUI() }\n\t\t\t\t\t{ renderCancelLink() }\n\t\t\t\t</>\n\t\t\t);\n\t\t\treturn renderPlaceholder( content );\n\t\t}\n\n\t\treturn renderPlaceholder( mediaLibraryButton );\n\t};\n\n\tif ( dropZoneUIOnly || disableMediaButtons ) {\n\t\tif ( dropZoneUIOnly ) {\n\t\t\tdeprecated( 'wp.blockEditor.MediaPlaceholder dropZoneUIOnly prop', {\n\t\t\t\talternative: 'disableMediaButtons',\n\t\t\t} );\n\t\t}\n\n\t\treturn <MediaUploadCheck>{ renderDropZone() }</MediaUploadCheck>;\n\t}\n\n\treturn (\n\t\t<MediaUploadCheck\n\t\t\tfallback={ renderPlaceholder( renderUrlSelectionUI() ) }\n\t\t>\n\t\t\t{ renderMediaUploadChecked() }\n\t\t</MediaUploadCheck>\n\t);\n}\n\n/**\n * @see https://github.com/WordPress/gutenberg/blob/master/packages/block-editor/src/components/media-placeholder/README.md\n */\nexport default withFilters( 'editor.MediaPlaceholder' )( MediaPlaceholder );\n"]}