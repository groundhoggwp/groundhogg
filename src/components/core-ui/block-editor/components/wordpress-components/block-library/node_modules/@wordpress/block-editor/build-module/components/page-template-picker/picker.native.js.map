{"version":3,"sources":["@wordpress/block-editor/src/components/page-template-picker/picker.native.js"],"names":["useState","useEffect","useRef","useDispatch","useSelect","Tooltip","logUserEvent","userEvents","requestStarterPageTemplatesTooltipShown","setStarterPageTemplatesTooltipShown","Animated","Dimensions","Keyboard","Button","Container","getDefaultTemplates","ModalPreview","PICKER_HEIGHT_OFFSET","__experimentalPageTemplatePicker","templates","visible","editPost","select","getEditedPostAttribute","title","templatePreview","setTemplatePreview","pickerVisible","setPickerVisible","tooltipVisible","setTooltipVisible","contentOpacity","Value","current","shouldShowPicker","startPickerAnimation","shouldShowTooltip","addListener","onKeyboardDidShow","onKeyboardDidHide","removeListener","windowHeight","get","height","tooltipShown","onApply","name","blocks","editorSessionTemplateApply","template","key","undefined","onTooltipHidden","isVisible","timing","toValue","duration","useNativeDriver","start","opacity","map","icon","editorSessionTemplatePreview"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState, useEffect, useRef } from '@wordpress/element';\nimport { useDispatch, useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport Tooltip from './tooltip';\n\n/**\n * External dependencies\n */\nimport {\n\tlogUserEvent,\n\tuserEvents,\n\trequestStarterPageTemplatesTooltipShown,\n\tsetStarterPageTemplatesTooltipShown,\n} from '@wordpress/react-native-bridge';\nimport { Animated, Dimensions, Keyboard } from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport Button from './button';\nimport Container from './container';\nimport getDefaultTemplates from './default-templates';\nimport ModalPreview from './preview';\n\n// Used to hide the picker if there's no enough space in the window\nconst PICKER_HEIGHT_OFFSET = 150;\n\nconst __experimentalPageTemplatePicker = ( {\n\ttemplates = getDefaultTemplates(),\n\tvisible,\n} ) => {\n\tconst { editPost } = useDispatch( 'core/editor' );\n\tconst { title } = useSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute } = select( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t};\n\t} );\n\n\tconst [ templatePreview, setTemplatePreview ] = useState();\n\tconst [ pickerVisible, setPickerVisible ] = useState( visible );\n\tconst [ tooltipVisible, setTooltipVisible ] = useState( false );\n\tconst contentOpacity = useRef( new Animated.Value( 0 ) ).current;\n\n\tuseEffect( () => {\n\t\tif ( shouldShowPicker() && visible && ! pickerVisible ) {\n\t\t\tsetPickerVisible( true );\n\t\t}\n\n\t\tstartPickerAnimation( visible );\n\t\tshouldShowTooltip();\n\n\t\tKeyboard.addListener( 'keyboardDidShow', onKeyboardDidShow );\n\t\tKeyboard.addListener( 'keyboardDidHide', onKeyboardDidHide );\n\n\t\treturn () => {\n\t\t\tKeyboard.removeListener( 'keyboardDidShow', onKeyboardDidShow );\n\t\t\tKeyboard.removeListener( 'keyboardDidHide', onKeyboardDidHide );\n\t\t};\n\t}, [ visible ] );\n\n\tuseEffect( () => {\n\t\tif ( tooltipVisible && templatePreview ) {\n\t\t\tsetTooltipVisible( false );\n\t\t}\n\t}, [ templatePreview ] );\n\n\tconst onKeyboardDidShow = () => {\n\t\tif ( visible ) {\n\t\t\tstartPickerAnimation( shouldShowPicker() );\n\t\t}\n\t};\n\n\tconst onKeyboardDidHide = () => {\n\t\tif ( visible ) {\n\t\t\tsetPickerVisible( true );\n\t\t\tstartPickerAnimation( true );\n\t\t}\n\t};\n\n\tconst shouldShowPicker = () => {\n\t\t// On smaller devices on landscape we hide the picker\n\t\t// so it doesn't overlap with the editor's content\n\t\tconst windowHeight = Dimensions.get( 'window' ).height;\n\t\treturn PICKER_HEIGHT_OFFSET < windowHeight / 3;\n\t};\n\n\tconst shouldShowTooltip = () => {\n\t\trequestStarterPageTemplatesTooltipShown( ( tooltipShown ) => {\n\t\t\tif ( ! tooltipShown ) {\n\t\t\t\tsetTooltipVisible( true );\n\t\t\t\tsetStarterPageTemplatesTooltipShown( true );\n\t\t\t}\n\t\t} );\n\t};\n\n\tconst onApply = () => {\n\t\teditPost( {\n\t\t\ttitle: title || templatePreview.name,\n\t\t\tblocks: templatePreview.blocks,\n\t\t} );\n\t\tlogUserEvent( userEvents.editorSessionTemplateApply, {\n\t\t\ttemplate: templatePreview.key,\n\t\t} );\n\t\tsetTemplatePreview( undefined );\n\t};\n\n\tconst onTooltipHidden = () => {\n\t\tsetTooltipVisible( false );\n\t};\n\n\tconst startPickerAnimation = ( isVisible ) => {\n\t\tAnimated.timing( contentOpacity, {\n\t\t\ttoValue: isVisible ? 1 : 0,\n\t\t\tduration: 300,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start( () => {\n\t\t\tif ( ! isVisible ) {\n\t\t\t\tsetPickerVisible( isVisible );\n\t\t\t}\n\t\t} );\n\t};\n\n\tif ( ! pickerVisible ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Animated.View style={ [ { opacity: contentOpacity } ] }>\n\t\t\t{ tooltipVisible && (\n\t\t\t\t<Tooltip onTooltipHidden={ onTooltipHidden } />\n\t\t\t) }\n\t\t\t<Container>\n\t\t\t\t{ templates.map( ( template ) => (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tkey={ template.key }\n\t\t\t\t\t\ticon={ template.icon }\n\t\t\t\t\t\tlabel={ template.name }\n\t\t\t\t\t\tonPress={ () => {\n\t\t\t\t\t\t\tlogUserEvent(\n\t\t\t\t\t\t\t\tuserEvents.editorSessionTemplatePreview,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttemplate: template.key,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tsetTemplatePreview( template );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) ) }\n\t\t\t</Container>\n\t\t\t<ModalPreview\n\t\t\t\ttemplate={ templatePreview }\n\t\t\t\tonDismiss={ () => setTemplatePreview( undefined ) }\n\t\t\t\tonApply={ onApply }\n\t\t\t/>\n\t\t</Animated.View>\n\t);\n};\n\nexport default __experimentalPageTemplatePicker;\n"]}