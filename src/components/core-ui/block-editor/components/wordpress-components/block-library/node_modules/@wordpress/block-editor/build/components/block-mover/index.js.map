{"version":3,"sources":["@wordpress/block-editor/src/components/block-mover/index.js"],"names":["BlockMover","isFirst","isLast","clientIds","isLocked","isHidden","rootClientId","orientation","hideDragHandle","isFocused","setIsFocused","onFocus","onBlur","isDraggable","onDraggableStart","onDraggableEnd","dragHandle","length","itemProps","select","getBlock","getBlockIndex","getBlockListSettings","getTemplateLock","getBlockOrder","getBlockRootClientId","normalizedClientIds","firstClientId","block","firstIndex","lastIndex","blockOrder","blockType","name"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { first, last, castArray } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\n\nimport { dragHandle } from '@wordpress/icons';\nimport { ToolbarGroup, ToolbarItem, Button } from '@wordpress/components';\nimport { getBlockType } from '@wordpress/blocks';\nimport { useState } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport { _n } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport BlockDraggable from '../block-draggable';\nimport { BlockMoverUpButton, BlockMoverDownButton } from './button';\n\nfunction BlockMover( {\n\tisFirst,\n\tisLast,\n\tclientIds,\n\tisLocked,\n\tisHidden,\n\trootClientId,\n\torientation,\n\thideDragHandle,\n} ) {\n\tconst [ isFocused, setIsFocused ] = useState( false );\n\n\tconst onFocus = () => setIsFocused( true );\n\tconst onBlur = () => setIsFocused( false );\n\n\tif ( isLocked || ( isFirst && isLast && ! rootClientId ) ) {\n\t\treturn null;\n\t}\n\n\t// We emulate a disabled state because forcefully applying the `disabled`\n\t// attribute on the buttons while it has focus causes the screen to change\n\t// to an unfocused state (body as active element) without firing blur on,\n\t// the rendering parent, leaving it unable to react to focus out.\n\treturn (\n\t\t<div\n\t\t\tclassName={ classnames( 'block-editor-block-mover', {\n\t\t\t\t'is-visible': isFocused || ! isHidden,\n\t\t\t\t'is-horizontal': orientation === 'horizontal',\n\t\t\t} ) }\n\t\t>\n\t\t\t{ ! hideDragHandle && (\n\t\t\t\t<BlockDraggable\n\t\t\t\t\tclientIds={ clientIds }\n\t\t\t\t\tcloneClassname=\"block-editor-block-mover__drag-clone\"\n\t\t\t\t>\n\t\t\t\t\t{ ( { isDraggable, onDraggableStart, onDraggableEnd } ) => (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ticon={ dragHandle }\n\t\t\t\t\t\t\tclassName=\"block-editor-block-mover__drag-handle\"\n\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\tlabel={ _n(\n\t\t\t\t\t\t\t\t'Drag block',\n\t\t\t\t\t\t\t\t'Drag blocks',\n\t\t\t\t\t\t\t\tclientIds.length\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t// Should not be able to tab to drag handle as this\n\t\t\t\t\t\t\t// button can only be used with a pointer device.\n\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\tonDragStart={ onDraggableStart }\n\t\t\t\t\t\t\tonDragEnd={ onDraggableEnd }\n\t\t\t\t\t\t\tdraggable={ isDraggable }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</BlockDraggable>\n\t\t\t) }\n\t\t\t<ToolbarGroup className=\"block-editor-block-mover__move-button-container\">\n\t\t\t\t<ToolbarItem onFocus={ onFocus } onBlur={ onBlur }>\n\t\t\t\t\t{ ( itemProps ) => (\n\t\t\t\t\t\t<BlockMoverUpButton\n\t\t\t\t\t\t\tclientIds={ clientIds }\n\t\t\t\t\t\t\t{ ...itemProps }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</ToolbarItem>\n\t\t\t\t<ToolbarItem onFocus={ onFocus } onBlur={ onBlur }>\n\t\t\t\t\t{ ( itemProps ) => (\n\t\t\t\t\t\t<BlockMoverDownButton\n\t\t\t\t\t\t\tclientIds={ clientIds }\n\t\t\t\t\t\t\t{ ...itemProps }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</ToolbarItem>\n\t\t\t</ToolbarGroup>\n\t\t</div>\n\t);\n}\n\nexport default withSelect( ( select, { clientIds } ) => {\n\tconst {\n\t\tgetBlock,\n\t\tgetBlockIndex,\n\t\tgetBlockListSettings,\n\t\tgetTemplateLock,\n\t\tgetBlockOrder,\n\t\tgetBlockRootClientId,\n\t} = select( 'core/block-editor' );\n\tconst normalizedClientIds = castArray( clientIds );\n\tconst firstClientId = first( normalizedClientIds );\n\tconst block = getBlock( firstClientId );\n\tconst rootClientId = getBlockRootClientId( first( normalizedClientIds ) );\n\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\tconst lastIndex = getBlockIndex(\n\t\tlast( normalizedClientIds ),\n\t\trootClientId\n\t);\n\tconst blockOrder = getBlockOrder( rootClientId );\n\tconst isFirst = firstIndex === 0;\n\tconst isLast = lastIndex === blockOrder.length - 1;\n\n\treturn {\n\t\tblockType: block ? getBlockType( block.name ) : null,\n\t\tisLocked: getTemplateLock( rootClientId ) === 'all',\n\t\trootClientId,\n\t\tfirstIndex,\n\t\tisFirst,\n\t\tisLast,\n\t\torientation: getBlockListSettings( rootClientId )?.orientation,\n\t};\n} )( BlockMover );\n"]}