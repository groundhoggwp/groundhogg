{"version":3,"sources":["@wordpress/block-editor/src/components/floating-toolbar/index.native.js"],"names":["EASE_IN_DURATION","EASE_OUT_DURATION","TRANSLATION_RANGE","opacity","Animated","Value","FloatingToolbar","selectedClientId","parentId","showFloatingToolbar","onNavigateUp","isRTL","previousSelection","setPreviousSelection","timing","toValue","duration","easing","Easing","ease","useNativeDriver","start","clientId","translationRange","Platform","OS","translation","interpolate","inputRange","outputRange","animationStyle","transform","translateY","previousSelectedClientId","previousSelectedParentId","showPrevious","blockSelectionButtonClientId","showNavUpButton","styles","floatingToolbar","toolbar","pipe","select","getSelectedBlockClientId","getBlockHierarchyRootClientId","getBlockRootClientId","getBlockCount","getSettings","rootBlockId","dispatch","selectBlock","initialPosition"],"mappings":";;;;;;;;;AASA;;;;AANA;;AAKA;;AAEA;;AACA;;AACA;;AAKA;;AACA;;AACA;;AAnBA;;;;AAKA;;;;AASA;;;AAOA,IAAMA,gBAAgB,GAAG,GAAzB;AACA,IAAMC,iBAAiB,GAAG,EAA1B;AACA,IAAMC,iBAAiB,GAAG,CAA1B;AAEA,IAAMC,OAAO,GAAG,IAAIC,sBAASC,KAAb,CAAoB,CAApB,CAAhB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,OAMjB;AAAA,MALNC,gBAKM,QALNA,gBAKM;AAAA,MAJNC,QAIM,QAJNA,QAIM;AAAA,MAHNC,mBAGM,QAHNA,mBAGM;AAAA,MAFNC,YAEM,QAFNA,YAEM;AAAA,MADNC,KACM,QADNA,KACM;;AACN;AADM,kBAE8C,uBAAU,EAAV,CAF9C;AAAA;AAAA,MAEEC,iBAFF;AAAA,MAEqBC,oBAFrB;;AAIN,0BAAW,YAAM;AAChBT,0BAASU,MAAT,CAAiBX,OAAjB,EAA0B;AACzBY,MAAAA,OAAO,EAAEN,mBAAmB,GAAG,CAAH,GAAO,CADV;AAEzBO,MAAAA,QAAQ,EAAEP,mBAAmB,GAC1BT,gBAD0B,GAE1BC,iBAJsB;AAKzBgB,MAAAA,MAAM,EAAEC,oBAAOC,IALU;AAMzBC,MAAAA,eAAe,EAAE;AANQ,KAA1B,EAOIC,KAPJ;AAQA,GATD,EASG,CAAEZ,mBAAF,CATH;AAWA,0BAAW,YAAM;AAChB,QAAKA,mBAAL,EACCI,oBAAoB,CAAE;AAAES,MAAAA,QAAQ,EAAEf,gBAAZ;AAA8BC,MAAAA,QAAQ,EAARA;AAA9B,KAAF,CAApB;AACD,GAHD,EAGG,CAAED,gBAAF,CAHH;AAKA,MAAMgB,gBAAgB,GACrB,CAAEC,sBAASC,EAAT,KAAgB,SAAhB,GAA4B,CAAC,CAA7B,GAAiC,CAAnC,IAAyCvB,iBAD1C;AAGA,MAAMwB,WAAW,GAAGvB,OAAO,CAACwB,WAAR,CAAqB;AACxCC,IAAAA,UAAU,EAAE,CAAE,CAAF,EAAK,CAAL,CAD4B;AAExCC,IAAAA,WAAW,EAAE,CAAEN,gBAAF,EAAoB,CAApB;AAF2B,GAArB,CAApB;AAKA,MAAMO,cAAc,GAAG;AACtB3B,IAAAA,OAAO,EAAPA,OADsB;AAEtB4B,IAAAA,SAAS,EAAE,CAAE;AAAEC,MAAAA,UAAU,EAAEN;AAAd,KAAF;AAFW,GAAvB;AA5BM,MAkCKO,wBAlCL,GAoCFrB,iBApCE,CAkCLU,QAlCK;AAAA,MAmCKY,wBAnCL,GAoCFtB,iBApCE,CAmCLJ,QAnCK;AAsCN,MAAM2B,YAAY,GAAGF,wBAAwB,IAAI,CAAExB,mBAAnD;AACA,MAAM2B,4BAA4B,GAAGD,YAAY,GAC9CF,wBAD8C,GAE9C1B,gBAFH;AAGA,MAAM8B,eAAe,GACpB,CAAC,CAAE7B,QAAH,IAAiB2B,YAAY,IAAI,CAAC,CAAED,wBADrC;AAGA,SACC,CAAC,CAAE/B,OAAH,IACC,4BAAC,qBAAD,CAAU,IAAV;AAAe,IAAA,KAAK,EAAG,CAAEmC,gBAAOC,eAAT,EAA0BT,cAA1B;AAAvB,KACGO,eAAe,IAChB,4BAAC,mBAAD;AAAS,IAAA,WAAW,EAAGC,gBAAOE;AAA9B,KACC,4BAAC,yBAAD;AACC,IAAA,KAAK,EAAG,cAAI,aAAJ,CADT;AAEC,IAAA,OAAO,EACN,CAAEL,YAAF,IACE;AAAA,aAAMzB,YAAY,CAAEF,QAAF,CAAlB;AAAA,KAJJ;AAMC,IAAA,IAAI,EAAG,4BAAC,kBAAD;AAAe,MAAA,KAAK,EAAGG;AAAvB;AANR,IADD,EASC,4BAAC,iBAAD;AAAM,IAAA,KAAK,EAAG2B,gBAAOG;AAArB,IATD,CAFF,EAcC,4BAAC,6BAAD;AACC,IAAA,QAAQ,EAAGL;AADZ,IAdD,CAFF;AAsBA,CAzED;;eA2Ee,sBAAS,CACvB,sBAAY,UAAEM,MAAF,EAAc;AAAA,gBAOrBA,MAAM,CAAE,mBAAF,CAPe;AAAA,MAExBC,wBAFwB,WAExBA,wBAFwB;AAAA,MAGxBC,6BAHwB,WAGxBA,6BAHwB;AAAA,MAIxBC,oBAJwB,WAIxBA,oBAJwB;AAAA,MAKxBC,aALwB,WAKxBA,aALwB;AAAA,MAMxBC,WANwB,WAMxBA,WANwB;;AASzB,MAAMxC,gBAAgB,GAAGoC,wBAAwB,EAAjD;AAEA,MAAK,CAAEpC,gBAAP,EAA0B;AAE1B,MAAMyC,WAAW,GAAGJ,6BAA6B,CAAErC,gBAAF,CAAjD;AAEA,SAAO;AACNA,IAAAA,gBAAgB,EAAhBA,gBADM;AAENE,IAAAA,mBAAmB,EAAE,CAAC,CAAEqC,aAAa,CAAEE,WAAF,CAF/B;AAGNxC,IAAAA,QAAQ,EAAEqC,oBAAoB,CAAEtC,gBAAF,CAHxB;AAINI,IAAAA,KAAK,EAAEoC,WAAW,GAAGpC;AAJf,GAAP;AAMA,CArBD,CADuB,EAuBvB,wBAAc,UAAEsC,QAAF,EAAgB;AAAA,kBACLA,QAAQ,CAAE,mBAAF,CADH;AAAA,MACrBC,WADqB,aACrBA,WADqB;;AAG7B,SAAO;AACNxC,IAAAA,YADM,wBACQY,QADR,EACkB6B,eADlB,EACoC;AACzCD,MAAAA,WAAW,CAAE5B,QAAF,EAAY6B,eAAZ,CAAX;AACA;AAHK,GAAP;AAKA,CARD,CAvBuB,CAAT,EAgCV7C,eAhCU,C","sourcesContent":["/**\n * External dependencies\n */\nimport { Animated, Easing, View, Platform } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { ToolbarButton, Toolbar } from '@wordpress/components';\nimport { useEffect, useState } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport NavigateUpSVG from './nav-up-icon';\nimport BlockSelectionButton from '../block-list/block-selection-button.native';\n\nconst EASE_IN_DURATION = 250;\nconst EASE_OUT_DURATION = 80;\nconst TRANSLATION_RANGE = 8;\n\nconst opacity = new Animated.Value( 0 );\n\nconst FloatingToolbar = ( {\n\tselectedClientId,\n\tparentId,\n\tshowFloatingToolbar,\n\tonNavigateUp,\n\tisRTL,\n} ) => {\n\t// Sustain old selection for proper block selection button rendering when exit animation is ongoing.\n\tconst [ previousSelection, setPreviousSelection ] = useState( {} );\n\n\tuseEffect( () => {\n\t\tAnimated.timing( opacity, {\n\t\t\ttoValue: showFloatingToolbar ? 1 : 0,\n\t\t\tduration: showFloatingToolbar\n\t\t\t\t? EASE_IN_DURATION\n\t\t\t\t: EASE_OUT_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start();\n\t}, [ showFloatingToolbar ] );\n\n\tuseEffect( () => {\n\t\tif ( showFloatingToolbar )\n\t\t\tsetPreviousSelection( { clientId: selectedClientId, parentId } );\n\t}, [ selectedClientId ] );\n\n\tconst translationRange =\n\t\t( Platform.OS === 'android' ? -1 : 1 ) * TRANSLATION_RANGE;\n\n\tconst translation = opacity.interpolate( {\n\t\tinputRange: [ 0, 1 ],\n\t\toutputRange: [ translationRange, 0 ],\n\t} );\n\n\tconst animationStyle = {\n\t\topacity,\n\t\ttransform: [ { translateY: translation } ],\n\t};\n\n\tconst {\n\t\tclientId: previousSelectedClientId,\n\t\tparentId: previousSelectedParentId,\n\t} = previousSelection;\n\n\tconst showPrevious = previousSelectedClientId && ! showFloatingToolbar;\n\tconst blockSelectionButtonClientId = showPrevious\n\t\t? previousSelectedClientId\n\t\t: selectedClientId;\n\tconst showNavUpButton =\n\t\t!! parentId || ( showPrevious && !! previousSelectedParentId );\n\n\treturn (\n\t\t!! opacity && (\n\t\t\t<Animated.View style={ [ styles.floatingToolbar, animationStyle ] }>\n\t\t\t\t{ showNavUpButton && (\n\t\t\t\t\t<Toolbar passedStyle={ styles.toolbar }>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\ttitle={ __( 'Navigate Up' ) }\n\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t! showPrevious &&\n\t\t\t\t\t\t\t\t( () => onNavigateUp( parentId ) )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticon={ <NavigateUpSVG isRTL={ isRTL } /> }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<View style={ styles.pipe } />\n\t\t\t\t\t</Toolbar>\n\t\t\t\t) }\n\t\t\t\t<BlockSelectionButton\n\t\t\t\t\tclientId={ blockSelectionButtonClientId }\n\t\t\t\t/>\n\t\t\t</Animated.View>\n\t\t)\n\t);\n};\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockHierarchyRootClientId,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockCount,\n\t\t\tgetSettings,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst selectedClientId = getSelectedBlockClientId();\n\n\t\tif ( ! selectedClientId ) return;\n\n\t\tconst rootBlockId = getBlockHierarchyRootClientId( selectedClientId );\n\n\t\treturn {\n\t\t\tselectedClientId,\n\t\t\tshowFloatingToolbar: !! getBlockCount( rootBlockId ),\n\t\t\tparentId: getBlockRootClientId( selectedClientId ),\n\t\t\tisRTL: getSettings().isRTL,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { selectBlock } = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tonNavigateUp( clientId, initialPosition ) {\n\t\t\t\tselectBlock( clientId, initialPosition );\n\t\t\t},\n\t\t};\n\t} ),\n] )( FloatingToolbar );\n"]}