{"version":3,"sources":["@wordpress/blocks/src/api/raw-handling/phrasing-content-reducer.js"],"names":["includes","wrap","replaceTag","phrasingContentReducer","node","doc","nodeName","style","fontWeight","fontStyle","textDecorationLine","textDecoration","verticalAlign","createElement","target","toLowerCase","rel","removeAttribute"],"mappings":"AAAA;;;AAGA,SAASA,QAAT,QAAyB,QAAzB;AAEA;;;;AAGA,SAASC,IAAT,EAAeC,UAAf,QAAiC,gBAAjC;AAEA,eAAe,SAASC,sBAAT,CAAiCC,IAAjC,EAAuCC,GAAvC,EAA6C;AAC3D;AACA;AACA,MAAKD,IAAI,CAACE,QAAL,KAAkB,MAAlB,IAA4BF,IAAI,CAACG,KAAtC,EAA8C;AAAA,sBAOzCH,IAAI,CAACG,KAPoC;AAAA,QAE5CC,UAF4C,eAE5CA,UAF4C;AAAA,QAG5CC,SAH4C,eAG5CA,SAH4C;AAAA,QAI5CC,kBAJ4C,eAI5CA,kBAJ4C;AAAA,QAK5CC,cAL4C,eAK5CA,cAL4C;AAAA,QAM5CC,aAN4C,eAM5CA,aAN4C;;AAS7C,QAAKJ,UAAU,KAAK,MAAf,IAAyBA,UAAU,KAAK,KAA7C,EAAqD;AACpDP,MAAAA,IAAI,CAAEI,GAAG,CAACQ,aAAJ,CAAmB,QAAnB,CAAF,EAAiCT,IAAjC,CAAJ;AACA;;AAED,QAAKK,SAAS,KAAK,QAAnB,EAA8B;AAC7BR,MAAAA,IAAI,CAAEI,GAAG,CAACQ,aAAJ,CAAmB,IAAnB,CAAF,EAA6BT,IAA7B,CAAJ;AACA,KAf4C,CAiB7C;AACA;AACA;;;AACA,QACCM,kBAAkB,KAAK,cAAvB,IACAV,QAAQ,CAAEW,cAAF,EAAkB,cAAlB,CAFT,EAGE;AACDV,MAAAA,IAAI,CAAEI,GAAG,CAACQ,aAAJ,CAAmB,GAAnB,CAAF,EAA4BT,IAA5B,CAAJ;AACA;;AAED,QAAKQ,aAAa,KAAK,OAAvB,EAAiC;AAChCX,MAAAA,IAAI,CAAEI,GAAG,CAACQ,aAAJ,CAAmB,KAAnB,CAAF,EAA8BT,IAA9B,CAAJ;AACA,KAFD,MAEO,IAAKQ,aAAa,KAAK,KAAvB,EAA+B;AACrCX,MAAAA,IAAI,CAAEI,GAAG,CAACQ,aAAJ,CAAmB,KAAnB,CAAF,EAA8BT,IAA9B,CAAJ;AACA;AACD,GAhCD,MAgCO,IAAKA,IAAI,CAACE,QAAL,KAAkB,GAAvB,EAA6B;AACnCF,IAAAA,IAAI,GAAGF,UAAU,CAAEE,IAAF,EAAQ,QAAR,CAAjB;AACA,GAFM,MAEA,IAAKA,IAAI,CAACE,QAAL,KAAkB,GAAvB,EAA6B;AACnCF,IAAAA,IAAI,GAAGF,UAAU,CAAEE,IAAF,EAAQ,IAAR,CAAjB;AACA,GAFM,MAEA,IAAKA,IAAI,CAACE,QAAL,KAAkB,GAAvB,EAA6B;AACnC;AACA;AACA,QAAKF,IAAI,CAACU,MAAL,IAAeV,IAAI,CAACU,MAAL,CAAYC,WAAZ,OAA8B,QAAlD,EAA6D;AAC5DX,MAAAA,IAAI,CAACY,GAAL,GAAW,qBAAX;AACA,KAFD,MAEO;AACNZ,MAAAA,IAAI,CAACa,eAAL,CAAsB,QAAtB;AACAb,MAAAA,IAAI,CAACa,eAAL,CAAsB,KAAtB;AACA;AACD;AACD","sourcesContent":["/**\n * External dependencies\n */\nimport { includes } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { wrap, replaceTag } from '@wordpress/dom';\n\nexport default function phrasingContentReducer( node, doc ) {\n\t// In jsdom-jscore, 'node.style' can be null.\n\t// TODO: Explore fixing this by patching jsdom-jscore.\n\tif ( node.nodeName === 'SPAN' && node.style ) {\n\t\tconst {\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\ttextDecorationLine,\n\t\t\ttextDecoration,\n\t\t\tverticalAlign,\n\t\t} = node.style;\n\n\t\tif ( fontWeight === 'bold' || fontWeight === '700' ) {\n\t\t\twrap( doc.createElement( 'strong' ), node );\n\t\t}\n\n\t\tif ( fontStyle === 'italic' ) {\n\t\t\twrap( doc.createElement( 'em' ), node );\n\t\t}\n\n\t\t// Some DOM implementations (Safari, JSDom) don't support\n\t\t// style.textDecorationLine, so we check style.textDecoration as a\n\t\t// fallback.\n\t\tif (\n\t\t\ttextDecorationLine === 'line-through' ||\n\t\t\tincludes( textDecoration, 'line-through' )\n\t\t) {\n\t\t\twrap( doc.createElement( 's' ), node );\n\t\t}\n\n\t\tif ( verticalAlign === 'super' ) {\n\t\t\twrap( doc.createElement( 'sup' ), node );\n\t\t} else if ( verticalAlign === 'sub' ) {\n\t\t\twrap( doc.createElement( 'sub' ), node );\n\t\t}\n\t} else if ( node.nodeName === 'B' ) {\n\t\tnode = replaceTag( node, 'strong' );\n\t} else if ( node.nodeName === 'I' ) {\n\t\tnode = replaceTag( node, 'em' );\n\t} else if ( node.nodeName === 'A' ) {\n\t\t// In jsdom-jscore, 'node.target' can be null.\n\t\t// TODO: Explore fixing this by patching jsdom-jscore.\n\t\tif ( node.target && node.target.toLowerCase() === '_blank' ) {\n\t\t\tnode.rel = 'noreferrer noopener';\n\t\t} else {\n\t\t\tnode.removeAttribute( 'target' );\n\t\t\tnode.removeAttribute( 'rel' );\n\t\t}\n\t}\n}\n"]}