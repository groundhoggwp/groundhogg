{"version":3,"sources":["@wordpress/api-fetch/src/middlewares/root-url.js"],"names":["createRootURLMiddleware","rootURL","options","next","optionsWithPath","url","path","apiRoot","indexOf","replace"],"mappings":";;;;;;;;;;;AAGA;;;;;;AAEA,IAAMA,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAEC,OAAF;AAAA,SAAe,UAAEC,OAAF,EAAWC,IAAX,EAAqB;AACnE,WAAO,gCAAgCD,OAAhC,EAAyC,UAAEE,eAAF,EAAuB;AACtE,UAAIC,GAAG,GAAGD,eAAe,CAACC,GAA1B;AACA,UAAIC,IAAI,GAAGF,eAAe,CAACE,IAA3B;AACA,UAAIC,OAAJ;;AAEA,UAAK,OAAOD,IAAP,KAAgB,QAArB,EAAgC;AAC/BC,QAAAA,OAAO,GAAGN,OAAV;;AAEA,YAAK,CAAC,CAAD,KAAOA,OAAO,CAACO,OAAR,CAAiB,GAAjB,CAAZ,EAAqC;AACpCF,UAAAA,IAAI,GAAGA,IAAI,CAACG,OAAL,CAAc,GAAd,EAAmB,GAAnB,CAAP;AACA;;AAEDH,QAAAA,IAAI,GAAGA,IAAI,CAACG,OAAL,CAAc,KAAd,EAAqB,EAArB,CAAP,CAP+B,CAS/B;AACA;;AACA,YACC,aAAa,OAAOF,OAApB,IACA,CAAC,CAAD,KAAOA,OAAO,CAACC,OAAR,CAAiB,GAAjB,CAFR,EAGE;AACDF,UAAAA,IAAI,GAAGA,IAAI,CAACG,OAAL,CAAc,GAAd,EAAmB,GAAnB,CAAP;AACA;;AAEDJ,QAAAA,GAAG,GAAGE,OAAO,GAAGD,IAAhB;AACA;;AAED,aAAOH,IAAI,iCACPC,eADO;AAEVC,QAAAA,GAAG,EAAHA;AAFU,SAAX;AAIA,KA9BM,CAAP;AA+BA,GAhC+B;AAAA,CAAhC;;eAkCeL,uB","sourcesContent":["/**\n * Internal dependencies\n */\nimport namespaceAndEndpointMiddleware from './namespace-endpoint';\n\nconst createRootURLMiddleware = ( rootURL ) => ( options, next ) => {\n\treturn namespaceAndEndpointMiddleware( options, ( optionsWithPath ) => {\n\t\tlet url = optionsWithPath.url;\n\t\tlet path = optionsWithPath.path;\n\t\tlet apiRoot;\n\n\t\tif ( typeof path === 'string' ) {\n\t\t\tapiRoot = rootURL;\n\n\t\t\tif ( -1 !== rootURL.indexOf( '?' ) ) {\n\t\t\t\tpath = path.replace( '?', '&' );\n\t\t\t}\n\n\t\t\tpath = path.replace( /^\\//, '' );\n\n\t\t\t// API root may already include query parameter prefix if site is\n\t\t\t// configured to use plain permalinks.\n\t\t\tif (\n\t\t\t\t'string' === typeof apiRoot &&\n\t\t\t\t-1 !== apiRoot.indexOf( '?' )\n\t\t\t) {\n\t\t\t\tpath = path.replace( '?', '&' );\n\t\t\t}\n\n\t\t\turl = apiRoot + path;\n\t\t}\n\n\t\treturn next( {\n\t\t\t...optionsWithPath,\n\t\t\turl,\n\t\t} );\n\t} );\n};\n\nexport default createRootURLMiddleware;\n"]}